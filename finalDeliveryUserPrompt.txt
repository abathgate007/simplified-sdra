Generate a Security Design Review Report in HTML using only the data provided below.  
Follow exactly the structure and rules defined in the system prompt.  
Do not invent information.  
If a required section has no data, still include the section header and state “No data provided.” 

{
  "trust_boundaries": {
    "schema_version": "1.0",
    "run_id": "run-2025-09-13T00:00:00Z",
    "boundaries": [
      {
        "id": "TB-001",
        "name": "Public Internet Boundary",
        "description": "Boundary between end-user networks and CES; all browser traffic traverses the public Internet to the CES web application.",
        "elements": [
          "EXT-001",
          "EXT-002",
          "EXT-003",
          "EXT-007",
          "P-000",
          "P-001"
        ]
      },
      {
        "id": "TB-002",
        "name": "SSO/Shibboleth Boundary",
        "description": "Trust boundary between CES and RIT Shibboleth IdP where SAML messages are exchanged.",
        "elements": [
          "P-001",
          "P-002",
          "EXT-004",
          "P-003"
        ]
      },
      {
        "id": "TB-003",
        "name": "Database Network Boundary",
        "description": "Boundary protecting the Oracle SQL database reachable only from the application tier/persistence framework.",
        "elements": [
          "P-001",
          "P-006",
          "DS-001",
          "P-005"
        ]
      },
      {
        "id": "TB-004",
        "name": "Reporting API Boundary",
        "description": "Boundary between CES reporting service and external reporting system (Jim's Reporting).",
        "elements": [
          "P-005",
          "EXT-005",
          "P-002",
          "EXT-006"
        ]
      },
      {
        "id": "TB-005",
        "name": "Mail Server Boundary",
        "description": "Boundary between CES notification service and ITS Mail Server over SMTP.",
        "elements": [
          "P-004",
          "EXT-006"
        ]
      },
      {
        "id": "TB-006",
        "name": "Web Reverse Proxy to Application Server Boundary",
        "description": "Boundary between ITS DNS/Web front end (reverse proxy) and the CES application server (Tomcat).",
        "elements": [
          "EXT-007",
          "P-001",
          "P-002",
          "P-005"
        ]
      },
      {
        "id": "TB-008",
        "name": "Session Management Boundary",
        "description": "Boundary spanning client and server handling session identifiers, cookies, and server-side session state.",
        "elements": [
          "P-000",
          "P-001",
          "DS-002"
        ]
      },
      {
        "id": "TB-009",
        "name": "Employer Authentication Boundary",
        "description": "Boundary for custom employer login handling credentials and auth flows distinct from SSO.",
        "elements": [
          "EXT-002",
          "P-003",
          "DS-003"
        ]
      }
    ],
    "evidence": [
      {
        "source_type": "requirement",
        "source_id": "SoftwareArchitectureDocumentation.pdf p.6-7, p.12-14",
        "quote": "components include Shibboleth for RIT user authentication, the ITS mail server for sending emails, and an Oracle SQL database for storing system information."
      },
      {
        "source_type": "diagram",
        "source_id": "p.13 Figure 3 (Data Flow)",
        "quote": "G[Shibboleth Authentication] --> H[Co-op Evaluation System] ... H --> L[ITS Mail Server] ... H --> J[Co-op Evaluation Database] ... I[Custom Employer Login] --> H"
      },
      {
        "source_type": "diagram",
        "source_id": "p.23 Figure 5 (Process View)",
        "quote": "B -->|Requests| C[Servlet] ... E -->|Queries| F[Oracle SQL Database]"
      },
      {
        "source_type": "assumption",
        "source_id": "Session management",
        "quote": "Server-side session store (in-memory or distributed) is typical for Tomcat/JSP and required to address session timeout scenarios."
      },
      {
        "source_type": "diagram",
        "source_id": "Figure 1",
        "quote": "Context diagram of the Co-op Evaluation System showing ITS DNS/Web Server, ITS Mail Server, Shibboleth, and Oracle SQL Database"
      },
      {
        "source_type": "requirement",
        "source_id": "Section 2",
        "quote": "The system must interface with Shibboleth for RIT user authentication, the ITS mail server for sending emails, and an Oracle SQL database"
      },
      {
        "source_type": "diagram",
        "source_id": "Figure 3",
        "quote": "Custom Employer Login shown as separate authentication path from Shibboleth Authentication"
      },
      {
        "source_type": "assumption",
        "source_id": "web-session-management",
        "quote": "Web applications require session state management for user authentication and authorization"
      }
    ]
  },
  "dfds": {
    "schema_version": "1.0",
    "run_id": "run-2025-09-13T00:00:00Z",
    "dfds": [
      {
        "id": "DFD-001",
        "title": "Co-op Evaluation System Context and Data Flows",
        "mermaid": "flowchart TD\n  EXT-001[EXT-001 Student User]\n  EXT-002[EXT-002 Employer User]\n  EXT-003[EXT-003 Administrator]\n  EXT-004[EXT-004 Shibboleth IdP]\n  EXT-005[EXT-005 Reporting System]\n  EXT-006[EXT-006 ITS Mail Server]\n  EXT-007[EXT-007 ITS DNS/Web Server]\n  P-000[P-000 Client Browser/UI (JS/Angular)]\n  P-001[P-001 CES Web Application (Servlet/JSP)]\n  P-002[P-002 SSO/SAML Controller]\n  P-003[P-003 Employer Local Auth Controller]\n  P-004[P-004 Email Notification Service]\n  P-005[P-005 Reporting Service]\n  P-006[P-006 Data Persistence Framework/ORM]\n  DS-001[DS-001 Oracle SQL Database]\n  DS-002[DS-002 Session Store]\n  DS-003[DS-003 Employer Credentials Store]\n  DS-004[DS-004 Audit/Logs]\n\n  EXT-001 -->|User actions| P-000\n  EXT-002 -->|User actions| P-000\n  EXT-003 -->|User actions| P-000\n  EXT-007 <--> |HTTPS reverse proxy| P-001\n  P-000 <--> |HTTPS requests/responses, cookies| P-001\n  P-001 -->|Initiate SSO| P-002\n  P-002 <--> |SAML AuthnRequest/Response| EXT-004\n  P-002 -->|SSO callback & attributes| P-001\n  P-000 -->|Employer credentials| P-003\n  P-003 <--> |Verify creds| DS-003\n  P-003 -->|Establish session| P-001\n  P-001 <--> |Create/Read/Update| DS-002\n  P-001 -->|Events| P-004\n  P-004 <--> |SMTP (TLS)| EXT-006\n  P-005 <--> |Export/Fetch reports| EXT-005\n  P-001 -->|CRUD requests| P-006\n  P-006 <--> |SQL/stored procedures| DS-001\n  P-005 -->|Report queries| DS-001\n  P-001 -->|App logs| DS-004\n  P-002 -->|Auth logs| DS-004\n  P-003 -->|Auth logs| DS-004\n  P-004 -->|Delivery logs| DS-004\n  P-005 -->|Report logs| DS-004\n  P-006 -->|DB ops logs| DS-004",
        "nodes": [
          {
            "id": "EXT-001",
            "type": "external_entity",
            "label": "Student User"
          },
          {
            "id": "EXT-002",
            "type": "external_entity",
            "label": "Employer User"
          },
          {
            "id": "EXT-003",
            "type": "external_entity",
            "label": "Administrator"
          },
          {
            "id": "EXT-004",
            "type": "external_entity",
            "label": "Shibboleth IdP"
          },
          {
            "id": "EXT-005",
            "type": "external_entity",
            "label": "Reporting System (Jim's Reporting)"
          },
          {
            "id": "EXT-006",
            "type": "external_entity",
            "label": "ITS Mail Server"
          },
          {
            "id": "EXT-007",
            "type": "external_entity",
            "label": "ITS DNS/Web Server (Reverse Proxy)"
          },
          {
            "id": "P-000",
            "type": "process",
            "label": "Client Browser/UI (JS/Angular)"
          },
          {
            "id": "P-001",
            "type": "process",
            "label": "CES Web Application (Servlet/JSP)"
          },
          {
            "id": "P-002",
            "type": "process",
            "label": "SSO/SAML Controller"
          },
          {
            "id": "P-003",
            "type": "process",
            "label": "Employer Local Auth Controller"
          },
          {
            "id": "P-004",
            "type": "process",
            "label": "Email Notification Service"
          },
          {
            "id": "P-005",
            "type": "process",
            "label": "Reporting Service"
          },
          {
            "id": "P-006",
            "type": "process",
            "label": "Data Persistence Framework/ORM"
          },
          {
            "id": "DS-001",
            "type": "data_store",
            "label": "Oracle SQL Database"
          },
          {
            "id": "DS-002",
            "type": "data_store",
            "label": "Session Store"
          },
          {
            "id": "DS-003",
            "type": "data_store",
            "label": "Employer Credentials Store"
          },
          {
            "id": "DS-004",
            "type": "data_store",
            "label": "Audit/Logs"
          }
        ],
        "edges": [
          {
            "from": "EXT-001",
            "to": "P-000",
            "label": "User actions (form input, navigation)"
          },
          {
            "from": "EXT-002",
            "to": "P-000",
            "label": "User actions (employer)"
          },
          {
            "from": "EXT-003",
            "to": "P-000",
            "label": "User actions (admin)"
          },
          {
            "from": "EXT-007",
            "to": "P-001",
            "label": "HTTPS reverse proxy"
          },
          {
            "from": "P-000",
            "to": "P-001",
            "label": "HTTPS requests/responses, cookies"
          },
          {
            "from": "P-001",
            "to": "P-002",
            "label": "Initiate SSO"
          },
          {
            "from": "P-002",
            "to": "EXT-004",
            "label": "SAML AuthnRequest/Response"
          },
          {
            "from": "P-002",
            "to": "P-001",
            "label": "SSO callback & attributes"
          },
          {
            "from": "P-000",
            "to": "P-003",
            "label": "Employer credentials (username/password)"
          },
          {
            "from": "P-003",
            "to": "DS-003",
            "label": "Verify credentials (hash compare)"
          },
          {
            "from": "P-003",
            "to": "P-001",
            "label": "Establish session (principal)"
          },
          {
            "from": "P-001",
            "to": "DS-002",
            "label": "Session create/read/update/destroy"
          },
          {
            "from": "P-001",
            "to": "P-004",
            "label": "Notification events (submission status)"
          },
          {
            "from": "P-004",
            "to": "EXT-006",
            "label": "SMTP (TLS)"
          },
          {
            "from": "P-005",
            "to": "EXT-005",
            "label": "Report export/import"
          },
          {
            "from": "P-001",
            "to": "P-006",
            "label": "CRUD requests"
          },
          {
            "from": "P-006",
            "to": "DS-001",
            "label": "SQL/stored procedures"
          },
          {
            "from": "P-005",
            "to": "DS-001",
            "label": "Report queries"
          },
          {
            "from": "P-001",
            "to": "DS-004",
            "label": "App logs"
          },
          {
            "from": "P-002",
            "to": "DS-004",
            "label": "Auth logs"
          },
          {
            "from": "P-003",
            "to": "DS-004",
            "label": "Auth logs"
          },
          {
            "from": "P-004",
            "to": "DS-004",
            "label": "Delivery logs"
          },
          {
            "from": "P-005",
            "to": "DS-004",
            "label": "Report logs"
          },
          {
            "from": "P-006",
            "to": "DS-004",
            "label": "DB ops logs"
          }
        ],
        "boundaries": [
          "TB-001",
          "TB-002",
          "TB-003",
          "TB-004",
          "TB-005",
          "TB-006",
          "TB-008",
          "TB-009"
        ]
      }
    ]
  },
  "stride_matrix": {
    "schema_version": "1.0",
    "run_id": "run-2025-09-13T00:00:00Z",
    "rows": [
      {
        "element_id": "P-000",
        "element_type": "process",
        "stride": "S",
        "applies": true,
        "example": "Spoofed/automated client (malicious user agent) impersonates a legitimate browser to bypass UI controls.",
        "evidence": [
          {
            "source_type": "diagram",
            "source_id": "p.18 Layered View",
            "quote": "Client ... AngularJS"
          }
        ]
      },
      {
        "element_id": "P-000",
        "element_type": "process",
        "stride": "T",
        "applies": true,
        "example": "DOM tampering/XSS via malicious input alters client-side state or requests."
      },
      {
        "element_id": "P-000",
        "element_type": "process",
        "stride": "R",
        "applies": true,
        "example": "User denies initiating actions; lack of client request correlation may hinder attribution."
      },
      {
        "element_id": "P-000",
        "element_type": "process",
        "stride": "I",
        "applies": true,
        "example": "Sensitive data exposed in browser storage/URL/referrer or through mixed content."
      },
      {
        "element_id": "P-000",
        "element_type": "process",
        "stride": "D",
        "applies": true,
        "example": "Resource exhaustion via heavy scripts or repeated polling degrades client/server."
      },
      {
        "element_id": "P-000",
        "element_type": "process",
        "stride": "E",
        "applies": true,
        "example": "XSS leads to session theft or CSRF token exfiltration, escalating privileges."
      },
      {
        "element_id": "P-001",
        "element_type": "process",
        "stride": "S",
        "applies": true,
        "example": "Session hijacking or forged cookies allow spoofing of authenticated users.",
        "evidence": [
          {
            "source_type": "assumption",
            "source_id": "Session cookies",
            "quote": "Web app uses session cookies for auth per JSP/Tomcat norms."
          }
        ]
      },
      {
        "element_id": "P-001",
        "element_type": "process",
        "stride": "T",
        "applies": true,
        "example": "Input tampering (e.g., parameter manipulation/SQLi) alters server state; enforce validation and ORM binding."
      },
      {
        "element_id": "P-001",
        "element_type": "process",
        "stride": "R",
        "applies": true,
        "example": "Missing or insufficient audit logs prevent tying actions to identities.",
        "evidence": [
          {
            "source_type": "requirement",
            "source_id": "p.9 Availability",
            "quote": "A meaningful error message is logged"
          }
        ]
      },
      {
        "element_id": "P-001",
        "element_type": "process",
        "stride": "I",
        "applies": true,
        "example": "Verbose errors or misconfigured caching disclose PII or stack traces."
      },
      {
        "element_id": "P-001",
        "element_type": "process",
        "stride": "D",
        "applies": true,
        "example": "DoS via expensive endpoints or lack of rate limiting; server becomes unresponsive.",
        "evidence": [
          {
            "source_type": "requirement",
            "source_id": "p.8 Availability",
            "quote": "DoS attack ... does not continue for longer than 1 minute."
          }
        ]
      },
      {
        "element_id": "P-001",
        "element_type": "process",
        "stride": "E",
        "applies": true,
        "example": "Broken access control lets users escalate roles (e.g., employer to admin)."
      },
      {
        "element_id": "P-002",
        "element_type": "process",
        "stride": "S",
        "applies": true,
        "example": "Attacker spins up rogue IdP to spoof identities; require issuer whitelist and signature verification.",
        "evidence": [
          {
            "source_type": "diagram",
            "source_id": "p.13 Figure 3",
            "quote": "Shibboleth Authentication"
          }
        ]
      },
      {
        "element_id": "P-002",
        "element_type": "process",
        "stride": "T",
        "applies": true,
        "example": "SAML message tampering (audience/recipient/NotOnOrAfter) if signatures not enforced."
      },
      {
        "element_id": "P-002",
        "element_type": "process",
        "stride": "R",
        "applies": true,
        "example": "Lack of SSO audit makes login assertions non-repudiable by neither party."
      },
      {
        "element_id": "P-002",
        "element_type": "process",
        "stride": "I",
        "applies": true,
        "example": "SAML attributes (email, roles) leaked via logs or referers on POST binding."
      },
      {
        "element_id": "P-002",
        "element_type": "process",
        "stride": "D",
        "applies": true,
        "example": "Flooding ACS endpoint with SAML responses to exhaust CPU/XML parsing."
      },
      {
        "element_id": "P-002",
        "element_type": "process",
        "stride": "E",
        "applies": true,
        "example": "Replay of valid assertions grants elevated roles; enforce one-time use and audience."
      },
      {
        "element_id": "P-003",
        "element_type": "process",
        "stride": "S",
        "applies": true,
        "example": "Credential stuffing/brute-force against employer login; apply rate limits/MFA.",
        "evidence": [
          {
            "source_type": "diagram",
            "source_id": "p.13 Figure 3",
            "quote": "Custom Employer Login"
          }
        ]
      },
      {
        "element_id": "P-003",
        "element_type": "process",
        "stride": "T",
        "applies": true,
        "example": "Tampering with password reset tokens or parameters to take over accounts."
      },
      {
        "element_id": "P-003",
        "element_type": "process",
        "stride": "R",
        "applies": true,
        "example": "No auth attempt logging; attackers can deny abusive activity."
      },
      {
        "element_id": "P-003",
        "element_type": "process",
        "stride": "I",
        "applies": true,
        "example": "Credential disclosure via verbose errors or timing/account enumeration."
      },
      {
        "element_id": "P-003",
        "element_type": "process",
        "stride": "D",
        "applies": true,
        "example": "DoS via login endpoint flood leading to lockout or CPU exhaustion (hashing)."
      },
      {
        "element_id": "P-003",
        "element_type": "process",
        "stride": "E",
        "applies": true,
        "example": "Bypassing role checks on callback can escalate employer to admin."
      },
      {
        "element_id": "P-004",
        "element_type": "process",
        "stride": "S",
        "applies": true,
        "example": "Email sender/domain spoofing if not authenticated; use SMTP AUTH, DKIM, SPF, DMARC."
      },
      {
        "element_id": "P-004",
        "element_type": "process",
        "stride": "T",
        "applies": true,
        "example": "Header injection via unvalidated input into email headers."
      },
      {
        "element_id": "P-004",
        "element_type": "process",
        "stride": "R",
        "applies": true,
        "example": "Lack of delivery logs hinders proof of notification."
      },
      {
        "element_id": "P-004",
        "element_type": "process",
        "stride": "I",
        "applies": true,
        "example": "PII leakage over SMTP if TLS not enforced; avoid sensitive content in subject/headers.",
        "evidence": [
          {
            "source_type": "requirement",
            "source_id": "p.6 Functional Requirements",
            "quote": "interact with ITS’s email server"
          }
        ]
      },
      {
        "element_id": "P-004",
        "element_type": "process",
        "stride": "D",
        "applies": true,
        "example": "Email storm from retry loops or template errors overwhelms MTA."
      },
      {
        "element_id": "P-004",
        "element_type": "process",
        "stride": "E",
        "applies": true,
        "example": "Template injection leading to code execution in mail service if unsafe rendering."
      },
      {
        "element_id": "P-005",
        "element_type": "process",
        "stride": "S",
        "applies": true,
        "example": "Unauthorized actor invokes reporting endpoints without proper authz."
      },
      {
        "element_id": "P-005",
        "element_type": "process",
        "stride": "T",
        "applies": true,
        "example": "Tampering with report parameters to alter results or access other tenants."
      },
      {
        "element_id": "P-005",
        "element_type": "process",
        "stride": "R",
        "applies": true,
        "example": "No audit of report generation/export leads to repudiation."
      },
      {
        "element_id": "P-005",
        "element_type": "process",
        "stride": "I",
        "applies": true,
        "example": "Reports leak PII beyond need-to-know; ensure aggregation/minimization.",
        "evidence": [
          {
            "source_type": "diagram",
            "source_id": "p.13 Figure 3",
            "quote": "H --> K[Jim's Reporting]"
          }
        ]
      },
      {
        "element_id": "P-005",
        "element_type": "process",
        "stride": "D",
        "applies": true,
        "example": "Expensive report queries cause DB contention/DoS."
      },
      {
        "element_id": "P-005",
        "element_type": "process",
        "stride": "E",
        "applies": true,
        "example": "Privilege escalation by exploiting overbroad report scopes."
      },
      {
        "element_id": "P-006",
        "element_type": "process",
        "stride": "S",
        "applies": false,
        "example": "N/A: ORM does not authenticate users; use least-privileged DB account."
      },
      {
        "element_id": "P-006",
        "element_type": "process",
        "stride": "T",
        "applies": true,
        "example": "SQL injection if bindings improperly used; ORM misuse can still permit tampering.",
        "evidence": [
          {
            "source_type": "diagram",
            "source_id": "p.23 Figure 5",
            "quote": "E[Data Persistence Framework]"
          }
        ]
      },
      {
        "element_id": "P-006",
        "element_type": "process",
        "stride": "R",
        "applies": true,
        "example": "Lack of DB operation audit trails prevents accountability."
      },
      {
        "element_id": "P-006",
        "element_type": "process",
        "stride": "I",
        "applies": true,
        "example": "Overprivileged DB credentials disclose data beyond need."
      },
      {
        "element_id": "P-006",
        "element_type": "process",
        "stride": "D",
        "applies": true,
        "example": "Long-running transactions lock tables causing availability issues."
      },
      {
        "element_id": "P-006",
        "element_type": "process",
        "stride": "E",
        "applies": true,
        "example": "Bypassing row-level checks at ORM layer can elevate data access."
      },
      {
        "element_id": "DS-001",
        "element_type": "data_store",
        "stride": "S",
        "applies": true,
        "example": "Impersonation using shared/system DB accounts; enforce strong auth and network ACLs."
      },
      {
        "element_id": "DS-001",
        "element_type": "data_store",
        "stride": "T",
        "applies": true,
        "example": "Unauthorized modification of evaluations/work reports via SQLi or direct DB access.",
        "evidence": [
          {
            "source_type": "requirement",
            "source_id": "p.6 Functional Requirements",
            "quote": "support concurrent reads and writes to the database"
          }
        ]
      },
      {
        "element_id": "DS-001",
        "element_type": "data_store",
        "stride": "R",
        "applies": true,
        "example": "Insufficient auditing prevents proving who changed records."
      },
      {
        "element_id": "DS-001",
        "element_type": "data_store",
        "stride": "I",
        "applies": true,
        "example": "PII disclosure from insecure queries/backups; ensure encryption at rest and access control."
      },
      {
        "element_id": "DS-001",
        "element_type": "data_store",
        "stride": "D",
        "applies": true,
        "example": "Lock contention or saturation under load leads to timeouts.",
        "evidence": [
          {
            "source_type": "requirement",
            "source_id": "p.8 Availability",
            "quote": "over 6,000 concurrent user requests"
          }
        ]
      },
      {
        "element_id": "DS-001",
        "element_type": "data_store",
        "stride": "E",
        "applies": true,
        "example": "Abusing stored procedures or DB scheduler to escalate privileges."
      },
      {
        "element_id": "DS-002",
        "element_type": "data_store",
        "stride": "S",
        "applies": true,
        "example": "Predictable session IDs or weak randomness enable session spoofing."
      },
      {
        "element_id": "DS-002",
        "element_type": "data_store",
        "stride": "T",
        "applies": true,
        "example": "Session fixation or unauthorized mutation of session state."
      },
      {
        "element_id": "DS-002",
        "element_type": "data_store",
        "stride": "R",
        "applies": true,
        "example": "Lack of session event logs allows repudiation of actions tied to session."
      },
      {
        "element_id": "DS-002",
        "element_type": "data_store",
        "stride": "I",
        "applies": true,
        "example": "Session IDs leaked via logs/referrers enable hijacking."
      },
      {
        "element_id": "DS-002",
        "element_type": "data_store",
        "stride": "D",
        "applies": true,
        "example": "Session store exhaustion causes widespread logouts/denials."
      },
      {
        "element_id": "DS-002",
        "element_type": "data_store",
        "stride": "E",
        "applies": true,
        "example": "Privilege escalation by binding session to wrong principal on auth."
      },
      {
        "element_id": "DS-003",
        "element_type": "data_store",
        "stride": "S",
        "applies": true,
        "example": "Account enumeration via timing/error differences when verifying credentials."
      },
      {
        "element_id": "DS-003",
        "element_type": "data_store",
        "stride": "T",
        "applies": true,
        "example": "Tampering with password hashes/salts enables offline cracking."
      },
      {
        "element_id": "DS-003",
        "element_type": "data_store",
        "stride": "R",
        "applies": true,
        "example": "Insufficient audit of credential changes (resets) allows repudiation."
      },
      {
        "element_id": "DS-003",
        "element_type": "data_store",
        "stride": "I",
        "applies": true,
        "example": "Disclosure of hashed passwords; enforce strong hashing (argon2/bcrypt) and secret handling."
      },
      {
        "element_id": "DS-003",
        "element_type": "data_store",
        "stride": "D",
        "applies": true,
        "example": "Frequent hashing operations under attack exhaust CPU, delaying legit auth."
      },
      {
        "element_id": "DS-003",
        "element_type": "data_store",
        "stride": "E",
        "applies": true,
        "example": "Weak hashing/work factors permit offline cracking and role escalation."
      },
      {
        "element_id": "DS-004",
        "element_type": "data_store",
        "stride": "S",
        "applies": true,
        "example": "Forged log entries (spoofed source) mislead investigations."
      },
      {
        "element_id": "DS-004",
        "element_type": "data_store",
        "stride": "T",
        "applies": true,
        "example": "Log tampering/deletion; protect with append-only/WORM and integrity checks.",
        "evidence": [
          {
            "source_type": "requirement",
            "source_id": "p.9 Availability",
            "quote": "A meaningful error message is logged"
          }
        ]
      },
      {
        "element_id": "DS-004",
        "element_type": "data_store",
        "stride": "R",
        "applies": true,
        "example": "If logs are mutable or missing, users can repudiate actions."
      },
      {
        "element_id": "DS-004",
        "element_type": "data_store",
        "stride": "I",
        "applies": true,
        "example": "Sensitive data (tokens/PII) written to logs leaks information."
      },
      {
        "element_id": "DS-004",
        "element_type": "data_store",
        "stride": "D",
        "applies": true,
        "example": "Log flooding fills disk, impacting availability."
      },
      {
        "element_id": "DS-004",
        "element_type": "data_store",
        "stride": "E",
        "applies": true,
        "example": "Overbroad log viewer permissions expose admin-only data."
      },
      {
        "element_id": "EXT-001",
        "element_type": "external_entity",
        "stride": "S",
        "applies": true,
        "example": "Attacker pretends to be a student user to gain access.",
        "evidence": [
          {
            "source_type": "diagram",
            "source_id": "p.13 Figure 3",
            "quote": "Student"
          }
        ]
      },
      {
        "element_id": "EXT-001",
        "element_type": "external_entity",
        "stride": "T",
        "applies": true,
        "example": "Malicious student input attempts to tamper with server-side data."
      },
      {
        "element_id": "EXT-001",
        "element_type": "external_entity",
        "stride": "R",
        "applies": true,
        "example": "Student denies submitting/altering an evaluation; ensure audit."
      },
      {
        "element_id": "EXT-001",
        "element_type": "external_entity",
        "stride": "I",
        "applies": true,
        "example": "Student could exfiltrate their own or others' data if improperly authorized."
      },
      {
        "element_id": "EXT-001",
        "element_type": "external_entity",
        "stride": "D",
        "applies": true,
        "example": "Student client floods endpoints causing DoS."
      },
      {
        "element_id": "EXT-001",
        "element_type": "external_entity",
        "stride": "E",
        "applies": true,
        "example": "Tries to escalate to admin features via IDOR or role misconfig."
      },
      {
        "element_id": "EXT-002",
        "element_type": "external_entity",
        "stride": "S",
        "applies": true,
        "example": "Fake employer attempts to access evaluations via custom login."
      },
      {
        "element_id": "EXT-002",
        "element_type": "external_entity",
        "stride": "T",
        "applies": true,
        "example": "Tampering attempts against employer evaluation inputs."
      },
      {
        "element_id": "EXT-002",
        "element_type": "external_entity",
        "stride": "R",
        "applies": true,
        "example": "Employer denies submitting an evaluation; correlate with IP/time and auth."
      },
      {
        "element_id": "EXT-002",
        "element_type": "external_entity",
        "stride": "I",
        "applies": true,
        "example": "Employer may try to view other employers' data; enforce access control."
      },
      {
        "element_id": "EXT-002",
        "element_type": "external_entity",
        "stride": "D",
        "applies": true,
        "example": "Credential stuffing floods login path causing lockouts."
      },
      {
        "element_id": "EXT-002",
        "element_type": "external_entity",
        "stride": "E",
        "applies": true,
        "example": "Attempts to escalate to admin by manipulating roles."
      },
      {
        "element_id": "EXT-003",
        "element_type": "external_entity",
        "stride": "S",
        "applies": true,
        "example": "Attacker impersonates administrator to access management functions."
      },
      {
        "element_id": "EXT-003",
        "element_type": "external_entity",
        "stride": "T",
        "applies": true,
        "example": "Admin-side parameter tampering risks system-wide changes."
      },
      {
        "element_id": "EXT-003",
        "element_type": "external_entity",
        "stride": "R",
        "applies": true,
        "example": "Admin denies approving/denying co-ops; ensure immutable audit."
      },
      {
        "element_id": "EXT-003",
        "element_type": "external_entity",
        "stride": "I",
        "applies": true,
        "example": "Admin device compromise leaks sensitive data."
      },
      {
        "element_id": "EXT-003",
        "element_type": "external_entity",
        "stride": "D",
        "applies": true,
        "example": "Bulk admin operations can overload system."
      },
      {
        "element_id": "EXT-003",
        "element_type": "external_entity",
        "stride": "E",
        "applies": true,
        "example": "Privilege escalation beyond intended admin scope."
      },
      {
        "element_id": "EXT-004",
        "element_type": "external_entity",
        "stride": "S",
        "applies": true,
        "example": "Rogue IdP spoofing Shibboleth; enforce metadata trust and TLS pinning.",
        "evidence": [
          {
            "source_type": "diagram",
            "source_id": "p.13 Figure 3",
            "quote": "Shibboleth Authentication"
          }
        ]
      },
      {
        "element_id": "EXT-004",
        "element_type": "external_entity",
        "stride": "T",
        "applies": true,
        "example": "Tampered SAML responses if signatures/conditions not validated."
      },
      {
        "element_id": "EXT-004",
        "element_type": "external_entity",
        "stride": "R",
        "applies": true,
        "example": "IdP/CES dispute over assertion use; maintain correlation IDs."
      },
      {
        "element_id": "EXT-004",
        "element_type": "external_entity",
        "stride": "I",
        "applies": true,
        "example": "Attribute over-release exposes more data than necessary."
      },
      {
        "element_id": "EXT-004",
        "element_type": "external_entity",
        "stride": "D",
        "applies": true,
        "example": "IdP outage degrades availability; implement graceful handling."
      },
      {
        "element_id": "EXT-004",
        "element_type": "external_entity",
        "stride": "E",
        "applies": true,
        "example": "If IdP sends elevated roles erroneously, users may gain extra privileges."
      },
      {
        "element_id": "EXT-005",
        "element_type": "external_entity",
        "stride": "S",
        "applies": true,
        "example": "Untrusted reporting client impersonates trusted system; use API auth."
      },
      {
        "element_id": "EXT-005",
        "element_type": "external_entity",
        "stride": "T",
        "applies": true,
        "example": "External system tampers with report payloads; validate schemas."
      },
      {
        "element_id": "EXT-005",
        "element_type": "external_entity",
        "stride": "R",
        "applies": true,
        "example": "Lack of export logs prevents repudiation handling."
      },
      {
        "element_id": "EXT-005",
        "element_type": "external_entity",
        "stride": "I",
        "applies": true,
        "example": "PII leakage via exported reports; enforce minimization and protection."
      },
      {
        "element_id": "EXT-005",
        "element_type": "external_entity",
        "stride": "D",
        "applies": true,
        "example": "Bulk report pulls overload CES/DB."
      },
      {
        "element_id": "EXT-005",
        "element_type": "external_entity",
        "stride": "E",
        "applies": true,
        "example": "External system misuses elevated API scopes to access data."
      },
      {
        "element_id": "EXT-006",
        "element_type": "external_entity",
        "stride": "S",
        "applies": true,
        "example": "Impersonated mail server via MX/DNS poisoning; enforce MTAs and cert checks.",
        "evidence": [
          {
            "source_type": "diagram",
            "source_id": "p.13 Figure 3",
            "quote": "ITS Mail Server"
          }
        ]
      },
      {
        "element_id": "EXT-006",
        "element_type": "external_entity",
        "stride": "T",
        "applies": true,
        "example": "Tampering with messages if STARTTLS downgraded; require TLS."
      },
      {
        "element_id": "EXT-006",
        "element_type": "external_entity",
        "stride": "R",
        "applies": true,
        "example": "No delivery receipts/audit trail causes repudiation."
      },
      {
        "element_id": "EXT-006",
        "element_type": "external_entity",
        "stride": "I",
        "applies": true,
        "example": "Email content disclosure over insecure links; minimize sensitive data in email."
      },
      {
        "element_id": "EXT-006",
        "element_type": "external_entity",
        "stride": "D",
        "applies": true,
        "example": "Mail server throttle/outage delays notifications."
      },
      {
        "element_id": "EXT-006",
        "element_type": "external_entity",
        "stride": "E",
        "applies": true,
        "example": "If CES creds on MTA overprivileged, attacker can abuse to send as trusted domains."
      },
      {
        "element_id": "EXT-007",
        "element_type": "external_entity",
        "stride": "S",
        "applies": true,
        "example": "Spoofed reverse proxy or misrouted DNS sends traffic to attacker.",
        "evidence": [
          {
            "source_type": "diagram",
            "source_id": "p.12 Figure 1",
            "quote": "ITS DNS/Web Server"
          }
        ]
      },
      {
        "element_id": "EXT-007",
        "element_type": "external_entity",
        "stride": "T",
        "applies": true,
        "example": "Header/body tampering at proxy; enforce header allowlists and TLS."
      },
      {
        "element_id": "EXT-007",
        "element_type": "external_entity",
        "stride": "R",
        "applies": true,
        "example": "Lack of proxy access logs hinders traceability."
      },
      {
        "element_id": "EXT-007",
        "element_type": "external_entity",
        "stride": "I",
        "applies": true,
        "example": "Proxy logs may disclose cookies/URLs; scrub sensitive fields."
      },
      {
        "element_id": "EXT-007",
        "element_type": "external_entity",
        "stride": "D",
        "applies": true,
        "example": "Proxy overload blocks access to CES."
      },
      {
        "element_id": "EXT-007",
        "element_type": "external_entity",
        "stride": "E",
        "applies": true,
        "example": "Overbroad proxy rules could bypass app auth (path rewrites)."
      }
    ],
    "coverage_pct": 88.0
  }
}

{
  "dread": {
    "schema_version": "1.0",
    "run_id": "run-2025-09-13T00:00:00Z",
    "ratings": [
      {
        "threat_id": "TH-0081",
        "element_id": "P-000",
        "stride": "S",
        "dread": { "damage": 5, "reproducibility": 7, "exploitability": 7, "affected_users": 6, "discoverability": 8 },
        "score": 33,
        "severity": "High",
        "rationale": "Spoofed/automated client bypasses UI controls; server-side authz must not trust client type."
      },
      {
        "threat_id": "TH-0082",
        "element_id": "P-000",
        "stride": "T",
        "dread": { "damage": 8, "reproducibility": 7, "exploitability": 8, "affected_users": 7, "discoverability": 7 },
        "score": 37,
        "severity": "High",
        "rationale": "DOM tampering/XSS can alter requests and inject malicious payloads."
      },
      {
        "threat_id": "TH-0083",
        "element_id": "P-000",
        "stride": "R",
        "dread": { "damage": 5, "reproducibility": 8, "exploitability": 7, "affected_users": 6, "discoverability": 7 },
        "score": 33,
        "severity": "High",
        "rationale": "Insufficient client request correlation enables denial of actions by users."
      },
      {
        "threat_id": "TH-0084",
        "element_id": "P-000",
        "stride": "I",
        "dread": { "damage": 7, "reproducibility": 7, "exploitability": 7, "affected_users": 7, "discoverability": 7 },
        "score": 35,
        "severity": "High",
        "rationale": "Sensitive data in URL, storage, or mixed content can leak via browser/referrers."
      },
      {
        "threat_id": "TH-0085",
        "element_id": "P-000",
        "stride": "D",
        "dread": { "damage": 6, "reproducibility": 8, "exploitability": 8, "affected_users": 8, "discoverability": 7 },
        "score": 37,
        "severity": "High",
        "rationale": "Heavy scripts/polling or automation can exhaust client/server resources."
      },
      {
        "threat_id": "TH-0086",
        "element_id": "P-000",
        "stride": "E",
        "dread": { "damage": 9, "reproducibility": 7, "exploitability": 8, "affected_users": 7, "discoverability": 7 },
        "score": 38,
        "severity": "High",
        "rationale": "XSS can steal sessions/CSRF tokens and escalate privileges."
      },
      {
        "threat_id": "TH-0205",
        "element_id": "P-000",
        "stride": "E",
        "dread": { "damage": 7, "reproducibility": 9, "exploitability": 8, "affected_users": 7, "discoverability": 8 },
        "score": 39,
        "severity": "High",
        "rationale": "Clickjacking via framing can trigger unintended state changes."
      },
      {
        "threat_id": "TH-0091",
        "element_id": "P-001",
        "stride": "S",
        "dread": { "damage": 8, "reproducibility": 8, "exploitability": 7, "affected_users": 7, "discoverability": 8 },
        "score": 38,
        "severity": "High",
        "rationale": "Session hijacking/forged cookies allow spoofing of authenticated users."
      },
      {
        "threat_id": "TH-0092",
        "element_id": "P-001",
        "stride": "T",
        "dread": { "damage": 9, "reproducibility": 7, "exploitability": 8, "affected_users": 8, "discoverability": 7 },
        "score": 39,
        "severity": "High",
        "rationale": "Input tampering/SQLi alters server state; insufficient validation/binding."
      },
      {
        "threat_id": "TH-0093",
        "element_id": "P-001",
        "stride": "R",
        "dread": { "damage": 6, "reproducibility": 9, "exploitability": 7, "affected_users": 6, "discoverability": 7 },
        "score": 35,
        "severity": "High",
        "rationale": "Missing or weak audit logs hinder attribution of actions."
      },
      {
        "threat_id": "TH-0094",
        "element_id": "P-001",
        "stride": "I",
        "dread": { "damage": 7, "reproducibility": 7, "exploitability": 7, "affected_users": 7, "discoverability": 7 },
        "score": 35,
        "severity": "High",
        "rationale": "Verbose errors/caching may disclose PII or stack traces."
      },
      {
        "threat_id": "TH-0095",
        "element_id": "P-001",
        "stride": "D",
        "dread": { "damage": 7, "reproducibility": 8, "exploitability": 8, "affected_users": 8, "discoverability": 7 },
        "score": 38,
        "severity": "High",
        "rationale": "Expensive endpoints and lack of rate limits can cause DoS."
      },
      {
        "threat_id": "TH-0096",
        "element_id": "P-001",
        "stride": "E",
        "dread": { "damage": 9, "reproducibility": 7, "exploitability": 8, "affected_users": 8, "discoverability": 7 },
        "score": 39,
        "severity": "High",
        "rationale": "Broken access control may allow role escalation (e.g., employer to admin)."
      },
      {
        "threat_id": "TH-0201",
        "element_id": "P-001",
        "stride": "E",
        "dread": { "damage": 8, "reproducibility": 8, "exploitability": 8, "affected_users": 8, "discoverability": 8 },
        "score": 40,
        "severity": "Critical",
        "rationale": "CSRF on state-changing endpoints can force victim actions with their privileges."
      },
      {
        "threat_id": "TH-0202",
        "element_id": "P-001",
        "stride": "E",
        "dread": { "damage": 10, "reproducibility": 8, "exploitability": 8, "affected_users": 8, "discoverability": 7 },
        "score": 41,
        "severity": "Critical",
        "rationale": "Insecure Java deserialization can enable remote code execution."
      },
      {
        "threat_id": "TH-0210",
        "element_id": "P-001",
        "stride": "T",
        "dread": { "damage": 9, "reproducibility": 7, "exploitability": 8, "affected_users": 8, "discoverability": 7 },
        "score": 39,
        "severity": "High",
        "rationale": "Mass assignment/over-posting may modify protected fields (e.g., role/status)."
      },
      {
        "threat_id": "TH-0207",
        "element_id": "P-001",
        "stride": "I",
        "dread": { "damage": 8, "reproducibility": 8, "exploitability": 8, "affected_users": 8, "discoverability": 8 },
        "score": 40,
        "severity": "Critical",
        "rationale": "CORS misconfig (e.g., '*' with credentials) enables cross-origin data exfil/abuse."
      },
      {
        "threat_id": "TH-0211",
        "element_id": "P-001",
        "stride": "S",
        "dread": { "damage": 7, "reproducibility": 8, "exploitability": 8, "affected_users": 7, "discoverability": 8 },
        "score": 38,
        "severity": "High",
        "rationale": "Open redirect after login enables phishing and session confusion."
      },
      {
        "threat_id": "TH-0101",
        "element_id": "P-002",
        "stride": "S",
        "dread": { "damage": 8, "reproducibility": 7, "exploitability": 7, "affected_users": 8, "discoverability": 7 },
        "score": 37,
        "severity": "High",
        "rationale": "Rogue IdP could spoof identities without strict issuer/metadata trust."
      },
      {
        "threat_id": "TH-0102",
        "element_id": "P-002",
        "stride": "T",
        "dread": { "damage": 9, "reproducibility": 7, "exploitability": 7, "affected_users": 8, "discoverability": 7 },
        "score": 38,
        "severity": "High",
        "rationale": "SAML message tampering (conditions/audience) if signatures not enforced."
      },
      {
        "threat_id": "TH-0103",
        "element_id": "P-002",
        "stride": "R",
        "dread": { "damage": 6, "reproducibility": 8, "exploitability": 7, "affected_users": 6, "discoverability": 7 },
        "score": 34,
        "severity": "High",
        "rationale": "Insufficient SSO audit trails hinder repudiation handling."
      },
      {
        "threat_id": "TH-0104",
        "element_id": "P-002",
        "stride": "I",
        "dread": { "damage": 7, "reproducibility": 7, "exploitability": 7, "affected_users": 7, "discoverability": 7 },
        "score": 35,
        "severity": "High",
        "rationale": "SAML attributes may leak via logs or referrers."
      },
      {
        "threat_id": "TH-0105",
        "element_id": "P-002",
        "stride": "D",
        "dread": { "damage": 7, "reproducibility": 8, "exploitability": 7, "affected_users": 8, "discoverability": 7 },
        "score": 37,
        "severity": "High",
        "rationale": "Flooding ACS with SAML responses exhausts XML parsing/CPU."
      },
      {
        "threat_id": "TH-0106",
        "element_id": "P-002",
        "stride": "E",
        "dread": { "damage": 8, "reproducibility": 7, "exploitability": 7, "affected_users": 8, "discoverability": 7 },
        "score": 37,
        "severity": "High",
        "rationale": "Replay of valid assertions grants access without reuse protection."
      },
      {
        "threat_id": "TH-0203",
        "element_id": "P-002",
        "stride": "I",
        "dread": { "damage": 9, "reproducibility": 8, "exploitability": 8, "affected_users": 8, "discoverability": 7 },
        "score": 40,
        "severity": "Critical",
        "rationale": "SAML XML parser XXE may leak files or cause DoS unless DTD/XXE disabled."
      },
      {
        "threat_id": "TH-0204",
        "element_id": "P-002",
        "stride": "E",
        "dread": { "damage": 9, "reproducibility": 7, "exploitability": 7, "affected_users": 8, "discoverability": 7 },
        "score": 38,
        "severity": "High",
        "rationale": "XML Signature Wrapping can bypass signature checks and elevate access."
      },
      {
        "threat_id": "TH-0213",
        "element_id": "P-002",
        "stride": "T",
        "dread": { "damage": 7, "reproducibility": 8, "exploitability": 8, "affected_users": 7, "discoverability": 8 },
        "score": 38,
        "severity": "High",
        "rationale": "Unvalidated SSO redirect/RelayState manipulation can route users to attacker sites."
      },
      {
        "threat_id": "TH-0111",
        "element_id": "P-003",
        "stride": "S",
        "dread": { "damage": 8, "reproducibility": 9, "exploitability": 8, "affected_users": 7, "discoverability": 8 },
        "score": 40,
        "severity": "Critical",
        "rationale": "Credential stuffing/brute-force against employer login without rate limits/MFA."
      },
      {
        "threat_id": "TH-0112",
        "element_id": "P-003",
        "stride": "T",
        "dread": { "damage": 8, "reproducibility": 7, "exploitability": 7, "affected_users": 7, "discoverability": 7 },
        "score": 36,
        "severity": "High",
        "rationale": "Tampering with reset tokens/params could take over accounts."
      },
      {
        "threat_id": "TH-0113",
        "element_id": "P-003",
        "stride": "R",
        "dread": { "damage": 5, "reproducibility": 9, "exploitability": 8, "affected_users": 6, "discoverability": 7 },
        "score": 35,
        "severity": "High",
        "rationale": "No auth attempt logging allows denial of abusive activity."
      },
      {
        "threat_id": "TH-0114",
        "element_id": "P-003",
        "stride": "I",
        "dread": { "damage": 7, "reproducibility": 8, "exploitability": 7, "affected_users": 7, "discoverability": 7 },
        "score": 36,
        "severity": "High",
        "rationale": "Verbose errors/timing leaks reveal credentials/account existence."
      },
      {
        "threat_id": "TH-0115",
        "element_id": "P-003",
        "stride": "D",
        "dread": { "damage": 6, "reproducibility": 8, "exploitability": 7, "affected_users": 7, "discoverability": 7 },
        "score": 35,
        "severity": "High",
        "rationale": "Login flood/hash work exhausts CPU causing lockouts."
      },
      {
        "threat_id": "TH-0116",
        "element_id": "P-003",
        "stride": "E",
        "dread": { "damage": 8, "reproducibility": 7, "exploitability": 7, "affected_users": 7, "discoverability": 7 },
        "score": 36,
        "severity": "High",
        "rationale": "Bypassing role checks on callback can escalate employer to admin."
      },
      {
        "threat_id": "TH-0121",
        "element_id": "P-004",
        "stride": "S",
        "dread": { "damage": 6, "reproducibility": 8, "exploitability": 8, "affected_users": 7, "discoverability": 8 },
        "score": 37,
        "severity": "High",
        "rationale": "Email sender spoofing without authenticated channels."
      },
      {
        "threat_id": "TH-0122",
        "element_id": "P-004",
        "stride": "T",
        "dread": { "damage": 8, "reproducibility": 7, "exploitability": 8, "affected_users": 7, "discoverability": 7 },
        "score": 37,
        "severity": "High",
        "rationale": "Header injection via unvalidated input into email headers."
      },
      {
        "threat_id": "TH-0123",
        "element_id": "P-004",
        "stride": "R",
        "dread": { "damage": 5, "reproducibility": 8, "exploitability": 8, "affected_users": 6, "discoverability": 7 },
        "score": 34,
        "severity": "High",
        "rationale": "Lack of delivery logs prevents proving notifications."
      },
      {
        "threat_id": "TH-0124",
        "element_id": "P-004",
        "stride": "I",
        "dread": { "damage": 7, "reproducibility": 8, "exploitability": 7, "affected_users": 7, "discoverability": 7 },
        "score": 36,
        "severity": "High",
        "rationale": "PII leakage over SMTP if TLS not enforced; leak in headers/subject."
      },
      {
        "threat_id": "TH-0125",
        "element_id": "P-004",
        "stride": "D",
        "dread": { "damage": 6, "reproducibility": 8, "exploitability": 8, "affected_users": 7, "discoverability": 7 },
        "score": 36,
        "severity": "High",
        "rationale": "Email storm from retries/template issues overwhelms MTA."
      },
      {
        "threat_id": "TH-0126",
        "element_id": "P-004",
        "stride": "E",
        "dread": { "damage": 9, "reproducibility": 7, "exploitability": 7, "affected_users": 7, "discoverability": 7 },
        "score": 37,
        "severity": "High",
        "rationale": "Template injection could execute code in mail service."
      },
      {
        "threat_id": "TH-0131",
        "element_id": "P-005",
        "stride": "S",
        "dread": { "damage": 7, "reproducibility": 8, "exploitability": 7, "affected_users": 7, "discoverability": 7 },
        "score": 36,
        "severity": "High",
        "rationale": "Unauthorized invocation of reporting endpoints."
      },
      {
        "threat_id": "TH-0132",
        "element_id": "P-005",
        "stride": "T",
        "dread": { "damage": 8, "reproducibility": 7, "exploitability": 7, "affected_users": 7, "discoverability": 7 },
        "score": 36,
        "severity": "High",
        "rationale": "Tampering with report parameters to alter scope/results."
      },
      {
        "threat_id": "TH-0133",
        "element_id": "P-005",
        "stride": "R",
        "dread": { "damage": 5, "reproducibility": 8, "exploitability": 8, "affected_users": 6, "discoverability": 7 },
        "score": 34,
        "severity": "High",
        "rationale": "No audit of report generation/export enables repudiation."
      },
      {
        "threat_id": "TH-0134",
        "element_id": "P-005",
        "stride": "I",
        "dread": { "damage": 8, "reproducibility": 7, "exploitability": 7, "affected_users": 7, "discoverability": 7 },
        "score": 36,
        "severity": "High",
        "rationale": "Reports may leak PII beyond need-to-know."
      },
      {
        "threat_id": "TH-0135",
        "element_id": "P-005",
        "stride": "D",
        "dread": { "damage": 7, "reproducibility": 8, "exploitability": 7, "affected_users": 7, "discoverability": 7 },
        "score": 36,
        "severity": "High",
        "rationale": "Expensive queries can cause DB contention/DoS."
      },
      {
        "threat_id": "TH-0136",
        "element_id": "P-005",
        "stride": "E",
        "dread": { "damage": 8, "reproducibility": 7, "exploitability": 7, "affected_users": 7, "discoverability": 7 },
        "score": 36,
        "severity": "High",
        "rationale": "Overbroad report scopes can be abused to elevate access."
      },
      {
        "threat_id": "TH-0208",
        "element_id": "P-005",
        "stride": "E",
        "dread": { "damage": 8, "reproducibility": 8, "exploitability": 8, "affected_users": 7, "discoverability": 7 },
        "score": 38,
        "severity": "High",
        "rationale": "CSV/Excel formula injection can execute commands or exfiltrate credentials."
      },
      {
        "threat_id": "TH-0142",
        "element_id": "P-006",
        "stride": "T",
        "dread": { "damage": 9, "reproducibility": 7, "exploitability": 7, "affected_users": 8, "discoverability": 7 },
        "score": 38,
        "severity": "High",
        "rationale": "SQL injection via ORM misuse/unsafe queries."
      },
      {
        "threat_id": "TH-0143",
        "element_id": "P-006",
        "stride": "R",
        "dread": { "damage": 6, "reproducibility": 8, "exploitability": 7, "affected_users": 7, "discoverability": 7 },
        "score": 35,
        "severity": "High",
        "rationale": "L lack of DB operation audits hinders accountability."
      },
      {
        "threat_id": "TH-0144",
        "element_id": "P-006",
        "stride": "I",
        "dread": { "damage": 8, "reproducibility": 7, "exploitability": 7, "affected_users": 8, "discoverability": 7 },
        "score": 37,
        "severity": "High",
        "rationale": "Overprivileged DB credentials expose data beyond necessity."
      },
      {
        "threat_id": "TH-0145",
        "element_id": "P-006",
        "stride": "D",
        "dread": { "damage": 6, "reproducibility": 8, "exploitability": 7, "affected_users": 7, "discoverability": 7 },
        "score": 35,
        "severity": "High",
        "rationale": "Long transactions lock tables reducing availability."
      },
      {
        "threat_id": "TH-0146",
        "element_id": "P-006",
        "stride": "E",
        "dread": { "damage": 8, "reproducibility": 7, "exploitability": 7, "affected_users": 8, "discoverability": 7 },
        "score": 37,
        "severity": "High",
        "rationale": "Bypassing row-level checks at ORM enables unauthorized data access."
      },
      {
        "threat_id": "TH-0151",
        "element_id": "DS-001",
        "stride": "S",
        "dread": { "damage": 7, "reproducibility": 7, "exploitability": 7, "affected_users": 8, "discoverability": 6 },
        "score": 35,
        "severity": "High",
        "rationale": "Shared/system DB accounts allow impersonation; weak auth controls."
      },
      {
        "threat_id": "TH-0152",
        "element_id": "DS-001",
        "stride": "T",
        "dread": { "damage": 9, "reproducibility": 7, "exploitability": 7, "affected_users": 8, "discoverability": 7 },
        "score": 38,
        "severity": "High",
        "rationale": "Unauthorized modification via SQLi or direct DB access."
      },
      {
        "threat_id": "TH-0153",
        "element_id": "DS-001",
        "stride": "R",
        "dread": { "damage": 6, "reproducibility": 8, "exploitability": 7, "affected_users": 7, "discoverability": 7 },
        "score": 35,
        "severity": "High",
        "rationale": "Insufficient auditing prevents proving who changed records."
      },
      {
        "threat_id": "TH-0154",
        "element_id": "DS-001",
        "stride": "I",
        "dread": { "damage": 9, "reproducibility": 7, "exploitability": 7, "affected_users": 8, "discoverability": 7 },
        "score": 38,
        "severity": "High",
        "rationale": "PII disclosure from insecure queries/backups; at-rest controls needed."
      },
      {
        "threat_id": "TH-0155",
        "element_id": "DS-001",
        "stride": "D",
        "dread": { "damage": 7, "reproducibility": 8, "exploitability": 7, "affected_users": 8, "discoverability": 7 },
        "score": 37,
        "severity": "High",
        "rationale": "Lock contention/saturation under load leads to timeouts."
      },
      {
        "threat_id": "TH-0156",
        "element_id": "DS-001",
        "stride": "E",
        "dread": { "damage": 8, "reproducibility": 7, "exploitability": 7, "affected_users": 8, "discoverability": 7 },
        "score": 37,
        "severity": "High",
        "rationale": "Abusing stored procedures or DB scheduler to escalate privileges."
      },
      {
        "threat_id": "TH-0212",
        "element_id": "DS-001",
        "stride": "I",
        "dread": { "damage": 8, "reproducibility": 8, "exploitability": 8, "affected_users": 8, "discoverability": 7 },
        "score": 39,
        "severity": "High",
        "rationale": "Unencrypted DB transport (no TCPS/mTLS) risks interception/tampering."
      },
      {
        "threat_id": "TH-0161",
        "element_id": "DS-002",
        "stride": "S",
        "dread": { "damage": 9, "reproducibility": 8, "exploitability": 8, "affected_users": 8, "discoverability": 8 },
        "score": 41,
        "severity": "Critical",
        "rationale": "Predictable/weak session IDs enable session spoofing."
      },
      {
        "threat_id": "TH-0162",
        "element_id": "DS-002",
        "stride": "T",
        "dread": { "damage": 8, "reproducibility": 8, "exploitability": 8, "affected_users": 8, "discoverability": 7 },
        "score": 39,
        "severity": "High",
        "rationale": "Session fixation or unauthorized mutation of session state."
      },
      {
        "threat_id": "TH-0163",
        "element_id": "DS-002",
        "stride": "R",
        "dread": { "damage": 5, "reproducibility": 9, "exploitability": 8, "affected_users": 7, "discoverability": 7 },
        "score": 36,
        "severity": "High",
        "rationale": "Lack of session event logs allows repudiation."
      },
      {
        "threat_id": "TH-0164",
        "element_id": "DS-002",
        "stride": "I",
        "dread": { "damage": 9, "reproducibility": 8, "exploitability": 8, "affected_users": 8, "discoverability": 8 },
        "score": 41,
        "severity": "Critical",
        "rationale": "Session IDs leaked via logs/referrers enable hijacking."
      },
      {
        "threat_id": "TH-0165",
        "element_id": "DS-002",
        "stride": "D",
        "dread": { "damage": 7, "reproducibility": 8, "exploitability": 8, "affected_users": 8, "discoverability": 7 },
        "score": 38,
        "severity": "High",
        "rationale": "Session store exhaustion causes widespread logouts/denials."
      },
      {
        "threat_id": "TH-0166",
        "element_id": "DS-002",
        "stride": "E",
        "dread": { "damage": 9, "reproducibility": 8, "exploitability": 8, "affected_users": 8, "discoverability": 7 },
        "score": 40,
        "severity": "Critical",
        "rationale": "Binding session to wrong principal enables privilege escalation."
      },
      {
        "threat_id": "TH-0171",
        "element_id": "DS-003",
        "stride": "S",
        "dread": { "damage": 6, "reproducibility": 8, "exploitability": 8, "affected_users": 7, "discoverability": 8 },
        "score": 37,
        "severity": "High",
        "rationale": "Account enumeration via timing/error differences."
      },
      {
        "threat_id": "TH-0172",
        "element_id": "DS-003",
        "stride": "T",
        "dread": { "damage": 8, "reproducibility": 7, "exploitability": 7, "affected_users": 7, "discoverability": 7 },
        "score": 36,
        "severity": "High",
        "rationale": "Tampering with password hashes/salts enables offline cracking."
      },
      {
        "threat_id": "TH-0173",
        "element_id": "DS-003",
        "stride": "R",
        "dread": { "damage": 6, "reproducibility": 8, "exploitability": 7, "affected_users": 6, "discoverability": 7 },
        "score": 34,
        "severity": "High",
        "rationale": "Insufficient audit of credential changes allows repudiation."
      },
      {
        "threat_id": "TH-0174",
        "element_id": "DS-003",
        "stride": "I",
        "dread": { "damage": 8, "reproducibility": 8, "exploitability": 8, "affected_users": 8, "discoverability": 7 },
        "score": 39,
        "severity": "High",
        "rationale": "Disclosure of hashed passwords risks offline cracking."
      },
      {
        "threat_id": "TH-0175",
        "element_id": "DS-003",
        "stride": "D",
        "dread": { "damage": 6, "reproducibility": 8, "exploitability": 7, "affected_users": 7, "discoverability": 7 },
        "score": 35,
        "severity": "High",
        "rationale": "Frequent hashing under attack exhausts CPU, delaying auth."
      },
      {
        "threat_id": "TH-0176",
        "element_id": "DS-003",
        "stride": "E",
        "dread": { "damage": 9, "reproducibility": 8, "exploitability": 8, "affected_users": 8, "discoverability": 7 },
        "score": 40,
        "severity": "Critical",
        "rationale": "Weak hashing/work factors allow offline cracking and escalation."
      },
      {
        "threat_id": "TH-0181",
        "element_id": "DS-004",
        "stride": "S",
        "dread": { "damage": 6, "reproducibility": 7, "exploitability": 7, "affected_users": 7, "discoverability": 7 },
        "score": 34,
        "severity": "High",
        "rationale": "Forged log entries mislead investigations."
      },
      {
        "threat_id": "TH-0182",
        "element_id": "DS-004",
        "stride": "T",
        "dread": { "damage": 7, "reproducibility": 8, "exploitability": 7, "affected_users": 7, "discoverability": 7 },
        "score": 36,
        "severity": "High",
        "rationale": "Log tampering/deletion without integrity controls."
      },
      {
        "threat_id": "TH-0183",
        "element_id": "DS-004",
        "stride": "R",
        "dread": { "damage": 6, "reproducibility": 9, "exploitability": 8, "affected_users": 7, "discoverability": 7 },
        "score": 37,
        "severity": "High",
        "rationale": "If logs are mutable or missing, users can repudiate actions."
      },
      {
        "threat_id": "TH-0184",
        "element_id": "DS-004",
        "stride": "I",
        "dread": { "damage": 7, "reproducibility": 8, "exploitability": 8, "affected_users": 8, "discoverability": 8 },
        "score": 39,
        "severity": "High",
        "rationale": "Sensitive data (tokens/PII) in logs leaks information."
      },
      {
        "threat_id": "TH-0185",
        "element_id": "DS-004",
        "stride": "D",
        "dread": { "damage": 6, "reproducibility": 8, "exploitability": 7, "affected_users": 7, "discoverability": 7 },
        "score": 35,
        "severity": "High",
        "rationale": "Log flooding fills disk impacts availability."
      },
      {
        "threat_id": "TH-0186",
        "element_id": "DS-004",
        "stride": "E",
        "dread": { "damage": 7, "reproducibility": 7, "exploitability": 7, "affected_users": 7, "discoverability": 7 },
        "score": 35,
        "severity": "High",
        "rationale": "Overbroad log viewer permissions expose sensitive data."
      },
      {
        "threat_id": "TH-0041",
        "element_id": "EXT-004",
        "stride": "S",
        "dread": { "damage": 8, "reproducibility": 7, "exploitability": 7, "affected_users": 8, "discoverability": 7 },
        "score": 37,
        "severity": "High",
        "rationale": "Rogue IdP spoofing Shibboleth without strict metadata trust."
      },
      {
        "threat_id": "TH-0042",
        "element_id": "EXT-004",
        "stride": "T",
        "dread": { "damage": 9, "reproducibility": 7, "exploitability": 7, "affected_users": 8, "discoverability": 7 },
        "score": 38,
        "severity": "High",
        "rationale": "Tampered SAML responses if signatures/conditions not validated."
      },
      {
        "threat_id": "TH-0043",
        "element_id": "EXT-004",
        "stride": "R",
        "dread": { "damage": 6, "reproducibility": 8, "exploitability": 7, "affected_users": 7, "discoverability": 7 },
        "score": 35,
        "severity": "High",
        "rationale": "IdP/CES dispute over assertion use absent correlation IDs."
      },
      {
        "threat_id": "TH-0044",
        "element_id": "EXT-004",
        "stride": "I",
        "dread": { "damage": 7, "reproducibility": 7, "exploitability": 7, "affected_users": 8, "discoverability": 7 },
        "score": 36,
        "severity": "High",
        "rationale": "Attribute over-release exposes unnecessary PII."
      },
      {
        "threat_id": "TH-0045",
        "element_id": "EXT-004",
        "stride": "D",
        "dread": { "damage": 6, "reproducibility": 8, "exploitability": 7, "affected_users": 8, "discoverability": 6 },
        "score": 35,
        "severity": "High",
        "rationale": "IdP outage degrades availability of authentication."
      },
      {
        "threat_id": "TH-0046",
        "element_id": "EXT-004",
        "stride": "E",
        "dread": { "damage": 8, "reproducibility": 7, "exploitability": 7, "affected_users": 8, "discoverability": 7 },
        "score": 37,
        "severity": "High",
        "rationale": "If IdP sends elevated roles erroneously, users gain extra privileges."
      },
      {
        "threat_id": "TH-0051",
        "element_id": "EXT-005",
        "stride": "S",
        "dread": { "damage": 7, "reproducibility": 7, "exploitability": 7, "affected_users": 7, "discoverability": 7 },
        "score": 35,
        "severity": "High",
        "rationale": "Untrusted reporting client impersonates trusted system."
      },
      {
        "threat_id": "TH-0052",
        "element_id": "EXT-005",
        "stride": "T",
        "dread": { "damage": 7, "reproducibility": 7, "exploitability": 7, "affected_users": 7, "discoverability": 7 },
        "score": 35,
        "severity": "High",
        "rationale": "External system tampers with report payloads."
      },
      {
        "threat_id": "TH-0053",
        "element_id": "EXT-005",
        "stride": "R",
        "dread": { "damage": 5, "reproducibility": 8, "exploitability": 8, "affected_users": 6, "discoverability": 7 },
        "score": 34,
        "severity": "High",
        "rationale": "Lack of export logs prevents repudiation handling."
      },
      {
        "threat_id": "TH-0054",
        "element_id": "EXT-005",
        "stride": "I",
        "dread": { "damage": 8, "reproducibility": 7, "exploitability": 7, "affected_users": 8, "discoverability": 7 },
        "score": 37,
        "severity": "High",
        "rationale": "PII leakage via exported reports."
      },
      {
        "threat_id": "TH-0055",
        "element_id": "EXT-005",
        "stride": "D",
        "dread": { "damage": 7, "reproducibility": 8, "exploitability": 7, "affected_users": 8, "discoverability": 7 },
        "score": 37,
        "severity": "High",
        "rationale": "Bulk report pulls overload CES/DB."
      },
      {
        "threat_id": "TH-0056",
        "element_id": "EXT-005",
        "stride": "E",
        "dread": { "damage": 8, "reproducibility": 7, "exploitability": 7, "affected_users": 8, "discoverability": 7 },
        "score": 37,
        "severity": "High",
        "rationale": "External system misuses elevated API scopes to access data."
      },
      {
        "threat_id": "TH-0061",
        "element_id": "EXT-006",
        "stride": "S",
        "dread": { "damage": 7, "reproducibility": 7, "exploitability": 7, "affected_users": 7, "discoverability": 7 },
        "score": 35,
        "severity": "High",
        "rationale": "Impersonated mail server via DNS/MX poisoning."
      },
      {
        "threat_id": "TH-0062",
        "element_id": "EXT-006",
        "stride": "T",
        "dread": { "damage": 7, "reproducibility": 7, "exploitability": 7, "affected_users": 7, "discoverability": 7 },
        "score": 35,
        "severity": "High",
        "rationale": "Tampering with messages via STARTTLS downgrade."
      },
      {
        "threat_id": "TH-0063",
        "element_id": "EXT-006",
        "stride": "R",
        "dread": { "damage": 5, "reproducibility": 8, "exploitability": 8, "affected_users": 6, "discoverability": 7 },
        "score": 34,
        "severity": "High",
        "rationale": "No delivery receipts/audit trail causes repudiation."
      },
      {
        "threat_id": "TH-0064",
        "element_id": "EXT-006",
        "stride": "I",
        "dread": { "damage": 7, "reproducibility": 8, "exploitability": 7, "affected_users": 8, "discoverability": 7 },
        "score": 37,
        "severity": "High",
        "rationale": "Email content disclosure over insecure links."
      },
      {
        "threat_id": "TH-0065",
        "element_id": "EXT-006",
        "stride": "D",
        "dread": { "damage": 6, "reproducibility": 8, "exploitability": 7, "affected_users": 8, "discoverability": 7 },
        "score": 36,
        "severity": "High",
        "rationale": "Mail server throttle/outage delays notifications."
      },
      {
        "threat_id": "TH-0066",
        "element_id": "EXT-006",
        "stride": "E",
        "dread": { "damage": 8, "reproducibility": 7, "exploitability": 7, "affected_users": 7, "discoverability": 7 },
        "score": 36,
        "severity": "High",
        "rationale": "Overprivileged CES creds on MTA enable abuse."
      },
      {
        "threat_id": "TH-0071",
        "element_id": "EXT-007",
        "stride": "S",
        "dread": { "damage": 8, "reproducibility": 7, "exploitability": 7, "affected_users": 8, "discoverability": 7 },
        "score": 37,
        "severity": "High",
        "rationale": "Spoofed reverse proxy/misrouted DNS sends traffic to attacker."
      },
      {
        "threat_id": "TH-0072",
        "element_id": "EXT-007",
        "stride": "T",
        "dread": { "damage": 7, "reproducibility": 7, "exploitability": 7, "affected_users": 8, "discoverability": 7 },
        "score": 36,
        "severity": "High",
        "rationale": "Header/body tampering at proxy; improper normalization."
      },
      {
        "threat_id": "TH-0073",
        "element_id": "EXT-007",
        "stride": "R",
        "dread": { "damage": 5, "reproducibility": 8, "exploitability": 8, "affected_users": 7, "discoverability": 7 },
        "score": 35,
        "severity": "High",
        "rationale": "Lack of proxy access logs hinders traceability."
      },
      {
        "threat_id": "TH-0074",
        "element_id": "EXT-007",
        "stride": "I",
        "dread": { "damage": 7, "reproducibility": 7, "exploitability": 7, "affected_users": 8, "discoverability": 7 },
        "score": 36,
        "severity": "High",
        "rationale": "Proxy logs may disclose cookies/URLs."
      },
      {
        "threat_id": "TH-0075",
        "element_id": "EXT-007",
        "stride": "D",
        "dread": { "damage": 6, "reproducibility": 8, "exploitability": 7, "affected_users": 8, "discoverability": 7 },
        "score": 36,
        "severity": "High",
        "rationale": "Proxy overload blocks access to CES."
      },
      {
        "threat_id": "TH-0076",
        "element_id": "EXT-007",
        "stride": "E",
        "dread": { "damage": 8, "reproducibility": 7, "exploitability": 7, "affected_users": 8, "discoverability": 7 },
        "score": 37,
        "severity": "High",
        "rationale": "Overbroad proxy rules could bypass app auth (path rewrites)."
      },
      {
        "threat_id": "TH-0209",
        "element_id": "EXT-007",
        "stride": "I",
        "dread": { "damage": 8, "reproducibility": 8, "exploitability": 8, "affected_users": 8, "discoverability": 8 },
        "score": 40,
        "severity": "Critical",
        "rationale": "Cache poisoning/stale caching can disclose cross-user data."
      },
      {
        "threat_id": "TH-0206",
        "element_id": "EXT-007",
        "stride": "E",
        "dread": { "damage": 7, "reproducibility": 9, "exploitability": 8, "affected_users": 7, "discoverability": 8 },
        "score": 39,
        "severity": "High",
        "rationale": "Clickjacking if edge lacks frame protections."
      }
    ]
  },
  "annotated_dfds": [
    {
      "schema_version": "1.0",
      "run_id": "run-2025-09-13T00:00:00Z",
      "dfd_id": "DFD-001",
      "annotations": [
        {
          "annotation_id": "ANN-0001",
          "target_id": "P-000",
          "threat_ids": ["TH-0081","TH-0082","TH-0083","TH-0084","TH-0085","TH-0086","TH-0205"],
          "note": "Client across TB-001/TB-008; enforce CSP/XFO, input sanitization, TLS, anti-automation, secure cookies."
        },
        {
          "annotation_id": "ANN-0002",
          "target_id": "P-001",
          "threat_ids": ["TH-0091","TH-0092","TH-0093","TH-0094","TH-0095","TH-0096","TH-0201","TH-0202","TH-0207","TH-0210","TH-0211"],
          "note": "App server across TB-001/TB-006/TB-003/TB-002/TB-004/TB-005/TB-008; enforce authZ, CSRF, validation, CORS, rate limits."
        },
        {
          "annotation_id": "ANN-0003",
          "target_id": "P-002",
          "threat_ids": ["TH-0101","TH-0102","TH-0103","TH-0104","TH-0105","TH-0106","TH-0203","TH-0204","TH-0213"],
          "note": "SSO ACS across TB-002; validate signatures/conditions, disable DTD/XXE, anti-replay, strict redirect allowlist."
        },
        {
          "annotation_id": "ANN-0004",
          "target_id": "P-003",
          "threat_ids": ["TH-0111","TH-0112","TH-0113","TH-0114","TH-0115","TH-0116"],
          "note": "Employer auth across TB-009/TB-008; add MFA, rate limits, secrets hygiene, audit."
        },
        {
          "annotation_id": "ANN-0005",
          "target_id": "P-004",
          "threat_ids": ["TH-0121","TH-0122","TH-0123","TH-0124","TH-0125","TH-0126"],
          "note": "Mail across TB-005; enforce TLS, SPF/DKIM/DMARC, header validation, avoid PII in headers."
        },
        {
          "annotation_id": "ANN-0006",
          "target_id": "P-005",
          "threat_ids": ["TH-0131","TH-0132","TH-0133","TH-0134","TH-0135","TH-0136","TH-0208"],
          "note": "Reporting across TB-004; require API authZ, audit, throttling, CSV sanitization."
        },
        {
          "annotation_id": "ANN-0007",
          "target_id": "P-006",
          "threat_ids": ["TH-0142","TH-0143","TH-0144","TH-0145","TH-0146"],
          "note": "Persistence across TB-003; use parameterized queries, least privilege, transaction limits, audit."
        },
        {
          "annotation_id": "ANN-0008",
          "target_id": "DS-001",
          "threat_ids": ["TH-0151","TH-0152","TH-0153","TH-0154","TH-0155","TH-0156","TH-0212"],
          "note": "Oracle DB behind TB-003; enforce TCPS/mTLS, strong auth, auditing, at-rest controls, performance limits."
        },
        {
          "annotation_id": "ANN-0009",
          "target_id": "DS-002",
          "threat_ids": ["TH-0161","TH-0162","TH-0163","TH-0164","TH-0165","TH-0166"],
          "note": "Session store in TB-008; strong ID entropy, rotation, quotas, detailed session auditing."
        },
        {
          "annotation_id": "ANN-0010",
          "target_id": "DS-003",
          "threat_ids": ["TH-0171","TH-0172","TH-0173","TH-0174","TH-0175","TH-0176"],
          "note": "Employer creds store in TB-009; strong hashing (bcrypt/argon2), anti-enum, change audit."
        },
        {
          "annotation_id": "ANN-0011",
          "target_id": "DS-004",
          "threat_ids": ["TH-0181","TH-0182","TH-0183","TH-0184","TH-0185","TH-0186"],
          "note": "Logs; apply WORM/append-only, integrity checks, redaction, quotas, least-privilege viewing."
        },
        {
          "annotation_id": "ANN-0012",
          "target_id": "EXT-004",
          "threat_ids": ["TH-0041","TH-0042","TH-0043","TH-0044","TH-0045","TH-0046"],
          "note": "Shibboleth across TB-002; trust metadata, validate signatures, minimize attributes, monitor availability."
        },
        {
          "annotation_id": "ANN-0013",
          "target_id": "EXT-005",
          "threat_ids": ["TH-0051","TH-0052","TH-0053","TH-0054","TH-0055","TH-0056"],
          "note": "External reporting across TB-004; authenticate, validate schemas, throttle, log exports."
        },
        {
          "annotation_id": "ANN-0014",
          "target_id": "EXT-006",
          "threat_ids": ["TH-0061","TH-0062","TH-0063","TH-0064","TH-0065","TH-0066"],
          "note": "ITS Mail across TB-005; enforce TLS and domain auth, minimize sensitive content, audit delivery."
        },
        {
          "annotation_id": "ANN-0015",
          "target_id": "EXT-007",
          "threat_ids": ["TH-0071","TH-0072","TH-0073","TH-0074","TH-0075","TH-0076","TH-0209","TH-0206"],
          "note": "Reverse proxy across TB-001/TB-006; harden headers, cache controls, CSP frame-ancestors, logging/rate limits."
        }
      ]
    }
  ],
  "mitigations": {
    "schema_version": "1.0",
    "run_id": "run-2025-09-13T00:00:00Z",
    "items": [
      {
        "id": "MIT-0001",
        "title": "Session Security Hardening",
        "description": "Use Secure/HttpOnly/SameSite cookies, rotate on auth, bind to client context, short TTLs, strict session invalidation and renewal.",
        "threat_ids": ["TH-0091","TH-0201","TH-0161","TH-0162","TH-0164","TH-0165","TH-0166"],
        "priority": 1,
        "nist_csf": ["PR.AC-1","PR.AC-6","PR.PT-1"],
        "effort": "M",
        "dependencies": []
      },
      {
        "id": "MIT-0002",
        "title": "Robust Input Validation and ORM Binding",
        "description": "Validate/normalize inputs server-side, enforce strict schemas, use parameterized queries/ORM safe APIs, reject unexpected fields.",
        "threat_ids": ["TH-0092","TH-0142","TH-0152","TH-0210"],
        "priority": 2,
        "nist_csf": ["PR.IP-1","PR.DS-5","PR.PT-3"],
        "effort": "M",
        "dependencies": []
      },
      {
        "id": "MIT-0003",
        "title": "SAML Security Controls",
        "description": "Pin IdP metadata, validate signatures/conditions/audience, disable DTD/XXE, enforce one-time use, clock skew limits, strict redirect allowlist.",
        "threat_ids": ["TH-0101","TH-0102","TH-0106","TH-0203","TH-0204","TH-0213","TH-0041","TH-0042"],
        "priority": 3,
        "nist_csf": ["PR.AC-1","PR.DS-2","PR.PT-4","DE.CM-7"],
        "effort": "M",
        "dependencies": []
      },
      {
        "id": "MIT-0004",
        "title": "CSRF Protections",
        "description": "Per-request CSRF tokens, SameSite=Lax/Strict, double-submit where needed, verify origin/referer, make state changes idempotent.",
        "threat_ids": ["TH-0201"],
        "priority": 4,
        "nist_csf": ["PR.AC-3","PR.PT-3"],
        "effort": "S",
        "dependencies": ["MIT-0001"]
      },
      {
        "id": "MIT-0005",
        "title": "Access Control and Authorization",
        "description": "Enforce least privilege, role- and attribute-based checks on every request, deny-by-default, secure admin paths, policy tests.",
        "threat_ids": ["TH-0096","TH-0136","TH-0146","TH-0186","TH-0076","TH-0046"],
        "priority": 5,
        "nist_csf": ["PR.AC-4","PR.AC-6"],
        "effort": "M",
        "dependencies": []
      },
      {
        "id": "MIT-0006",
        "title": "Immutable Logging and Audit Trails",
        "description": "Centralize logs, enable WORM/append-only, integrity hashing, detailed audit for auth/session/DB ops, secure viewing and retention.",
        "threat_ids": ["TH-0093","TH-0103","TH-0113","TH-0153","TH-0163","TH-0181","TH-0182","TH-0183"],
        "priority": 6,
        "nist_csf": ["PR.PT-1","DE.CM-1","DE.CM-7"],
        "effort": "M",
        "dependencies": []
      },
      {
        "id": "MIT-0007",
        "title": "Rate Limiting and Anti-Automation",
        "description": "Apply IP/user-based throttling, CAPTCHA/risk-based challenges, account lockouts with safe backoff, per-endpoint budgets.",
        "threat_ids": ["TH-0095","TH-0105","TH-0111","TH-0115","TH-0135","TH-0155","TH-0075","TH-0055"],
        "priority": 7,
        "nist_csf": ["PR.PT-4","DE.CM-7"],
        "effort": "S",
        "dependencies": []
      },
      {
        "id": "MIT-0008",
        "title": "Email Channel Security",
        "description": "Require TLS with certificate validation, SPF/DKIM/DMARC, sanitize headers, avoid PII in subject/headers, bounce handling.",
        "threat_ids": ["TH-0121","TH-0122","TH-0124","TH-0125","TH-0061","TH-0062","TH-0064","TH-0066"],
        "priority": 8,
        "nist_csf": ["PR.DS-2","PR.PT-4"],
        "effort": "S",
        "dependencies": []
      },
      {
        "id": "MIT-0009",
        "title": "Reporting Export Hardening",
        "description": "Authorize every report, log exports, throttle, sanitize CSV by prefixing dangerous chars or generate safe XLSX.",
        "threat_ids": ["TH-0131","TH-0133","TH-0134","TH-0135","TH-0208","TH-0054","TH-0055"],
        "priority": 9,
        "nist_csf": ["PR.AC-4","PR.DS-5","DE.CM-7"],
        "effort": "S",
        "dependencies": []
      },
      {
        "id": "MIT-0010",
        "title": "Reverse Proxy Hardening and Caching Controls",
        "description": "Normalize/allowlist headers, auth-aware caching, strip hop-by-hop headers, set Cache-Control, enable CSP frame-ancestors.",
        "threat_ids": ["TH-0071","TH-0072","TH-0073","TH-0074","TH-0075","TH-0076","TH-0209","TH-0206","TH-0205"],
        "priority": 10,
        "nist_csf": ["PR.PT-4","PR.PT-3","DE.CM-7"],
        "effort": "S",
        "dependencies": []
      },
      {
        "id": "MIT-0011",
        "title": "CORS Lockdown",
        "description": "Disallow cross-origin by default; if needed, strict allowlist, exact origins, no credentials unless required, validate preflights.",
        "threat_ids": ["TH-0207"],
        "priority": 11,
        "nist_csf": ["PR.PT-4","PR.AC-3"],
        "effort": "S",
        "dependencies": []
      },
      {
        "id": "MIT-0012",
        "title": "Deserialization Protections",
        "description": "Remove native Java serialization; use JSON/XML mappers; if unavoidable, enforce ObjectInputFilter/allowlists and disable gadgets.",
        "threat_ids": ["TH-0202"],
        "priority": 12,
        "nist_csf": ["PR.PT-3","PR.IP-1"],
        "effort": "M",
        "dependencies": []
      },
      {
        "id": "MIT-0013",
        "title": "Mass Assignment Defense",
        "description": "Use DTOs/explicit binding allowlists; ignore unexpected fields; enforce server-side invariants on sensitive attributes.",
        "threat_ids": ["TH-0210"],
        "priority": 13,
        "nist_csf": ["PR.IP-1","PR.AC-4"],
        "effort": "S",
        "dependencies": []
      },
      {
        "id": "MIT-0014",
        "title": "Database Security and Transport Encryption",
        "description": "Least-privilege DB users, strong auth, auditing, TCPS with server cert validation/mTLS where possible, backup protection.",
        "threat_ids": ["TH-0151","TH-0152","TH-0153","TH-0154","TH-0155","TH-0156","TH-0212","TH-0144"],
        "priority": 14,
        "nist_csf": ["PR.DS-1","PR.DS-2","PR.AC-4","DE.CM-7"],
        "effort": "M",
        "dependencies": []
      },
      {
        "id": "MIT-0015",
        "title": "Session Store Hardening",
        "description": "High-entropy IDs, secure generation, per-user limits, eviction policies, encryption at rest, detailed session lifecycle logs.",
        "threat_ids": ["TH-0161","TH-0162","TH-0163","TH-0164","TH-0165","TH-0166"],
        "priority": 15,
        "nist_csf": ["PR.AC-1","PR.PT-1","PR.DS-1"],
        "effort": "S",
        "dependencies": ["MIT-0001","MIT-0006"]
      },
      {
        "id": "MIT-0016",
        "title": "Credential Store Hardening",
        "description": "Use argon2/bcrypt with strong work factors, unique salts, HSM/secret vaults, anti-enumeration, change event audits.",
        "threat_ids": ["TH-0171","TH-0172","TH-0173","TH-0174","TH-0175","TH-0176"],
        "priority": 16,
        "nist_csf": ["PR.AC-1","PR.DS-1","DE.CM-7"],
        "effort": "M",
        "dependencies": []
      },
      {
        "id": "MIT-0017",
        "title": "Clickjacking Defense",
        "description": "Set CSP frame-ancestors 'none' (or strict allowlist) and X-Frame-Options=DENY on state-changing routes at edge and app.",
        "threat_ids": ["TH-0205","TH-0206"],
        "priority": 17,
        "nist_csf": ["PR.PT-3"],
        "effort": "S",
        "dependencies": []
      },
      {
        "id": "MIT-0018",
        "title": "Redirect/Forward Allowlisting",
        "description": "Validate post-login return URLs/RelayState against allowlist; strip external hosts; avoid dangerous server-side forwards.",
        "threat_ids": ["TH-0211","TH-0213"],
        "priority": 18,
        "nist_csf": ["PR.PT-3","PR.AC-3"],
        "effort": "S",
        "dependencies": []
      },
      {
        "id": "MIT-0019",
        "title": "XSS Mitigations",
        "description": "Contextual output encoding, strict CSP, input sanitization, template auto-escaping, dependency review and SRI for assets.",
        "threat_ids": ["TH-0082","TH-0086","TH-0094"],
        "priority": 19,
        "nist_csf": ["PR.PT-3","PR.IP-1"],
        "effort": "M",
        "dependencies": []
      },
      {
        "id": "MIT-0020",
        "title": "DoS Resilience and Capacity",
        "description": "Pre-compute caches, queue work, circuit breakers, timeouts, autoscaling, per-endpoint budgets, backpressure and graceful degradation.",
        "threat_ids": ["TH-0085","TH-0095","TH-0105","TH-0115","TH-0135","TH-0155","TH-0165","TH-0075","TH-0055","TH-0065"],
        "priority": 20,
        "nist_csf": ["PR.PT-4","RS.AN-1","RC.IM-1"],
        "effort": "L",
        "dependencies": ["MIT-0007"]
      }
    ]
  }
}