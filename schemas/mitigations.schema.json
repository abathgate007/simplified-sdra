{
    "$id": "mitigations.schema.json",
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "title": "Mitigations",
    "type": "object",
    "required": ["schema_version", "run_id", "items"],
    "properties": {
      "schema_version": { "type": "string", "const": "1.0" },
      "run_id": { "type": "string" },
      "items": {
        "type": "array",
        "items": {
          "type": "object",
          "required": ["id","title","description","threat_ids","priority","nist_csf","effort","dependencies"],
          "properties": {
            "id": { "type": "string", "pattern": "^MIT-[0-9]{4}$" },
            "title": { "type": "string" },
            "description": { "type": "string", "maxLength": 300 },
            "threat_ids": {
              "type": "array",
              "items": { "type": "string", "pattern": "^TH-[0-9]{4}$" }
            },
            "priority": { "type": "integer", "minimum": 1, "maximum": 9999 },
            "nist_csf": {
              "type": "array",
              "description": "NIST CSF function.category.subcategory (e.g., PR.AC-1).",
              "items": { "type": "string", "pattern": "^(ID|PR|DE|RS|RC)\\.[A-Z]{2}-[0-9]+$" }
            },
            "effort": { "type": "string", "enum": ["S","M","L"] },
            "dependencies": { "type": "array", "items": { "type": "string", "pattern": "^MIT-[0-9]{4}$" } }
          }
        }
      }
    }
  }
  