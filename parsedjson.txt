[
  "{\n  \"trust_boundaries\": {\n    \"schema_version\": \"1.0\",\n    \"run_id\": \"umds-20240612\",\n    \"boundaries\": [\n      {\n        \"id\": \"TB-001\",\n        \"name\": \"External Network Boundary\",\n        \"description\": \"Separates external users from the UMDS application hosted on the internal trusted network.\",\n        \"elements\": [\"EXT-001\"]\n      },\n      {\n        \"id\": \"TB-002\",\n        \"name\": \"Web Application Trust Boundary\",\n        \"description\": \"Controls web interactions between users (internal/external) and the PHP web application.\",\n        \"elements\": [\"P-001\"]\n      },\n      {\n        \"id\": \"TB-003\",\n        \"name\": \"Database Trust Boundary\",\n        \"description\": \"Boundary between the PHP backend and the MySQL/MariaDB data store where all credential and directory info is stored.\",\n        \"elements\": [\"DS-001\"]\n      },\n      {\n        \"id\": \"TB-004\",\n        \"name\": \"Server OS/File System Boundary\",\n        \"description\": \"Boundary between PHP application logic and system resources accessed for file upload and command execution.\",\n        \"elements\": [\"P-001\"]\n      },\n      {\n        \"id\": \"TB-005\",\n        \"name\": \"File Storage Boundary\",\n        \"description\": \"Boundary between PHP application and the web-accessible upload directory.\",\n        \"elements\": [\"DS-002\"]\n      }\n    ],\n    \"evidence\": [\n      {\n        \"source_type\": \"requirement\",\n        \"source_id\": \"requirements.pdf#3.3\",\n        \"quote\": \"Simple File Structure\"\n      },\n      {\n        \"source_type\": \"requirement\",\n        \"source_id\": \"requirements.pdf#3.1\",\n        \"quote\": \"PHP with procedural programming approach; Direct database connectivity\"\n      },\n      {\n        \"source_type\": \"requirement\",\n        \"source_id\": \"requirements.pdf#4.3\",\n        \"quote\": \"Web-accessible upload directory\"\n      },\n      {\n        \"source_type\": \"requirement\",\n        \"source_id\": \"requirements.pdf#4.4\",\n        \"quote\": \"Direct system command execution\"\n      },\n      {\n        \"source_type\": \"assumption\",\n        \"source_id\": \"archiecture_diagram.jpg\",\n        \"quote\": \"No explicit network segmentation shown; boundaries inferred from web and database layers\"\n      }\n    ]\n  },\n  \"dfds\": {\n    \"schema_version\": \"1.0\",\n    \"run_id\": \"umds-20240612\",\n    \"dfds\": [\n      {\n        \"id\": \"DFD-001\",\n        \"title\": \"UMDS Level 1 DFD\",\n        \"mermaid\": \"graph TB;\\n  EXT-001([User]) -->|HTTP/S Requests| P-001((UMDS PHP Application));\\n  P-001 -->|Queries| DS-001[(MySQL/MariaDB Database)];\\n  P-001 -->|Read/Write| DS-002[(Upload Directory)];\\n  P-001 -->|Command| EXT-002([OS System Shell]);\\n  EXT-001 -->|File Upload| P-001;\\n  P-001 -->|Error/Output| EXT-001;\\n\",\n        \"nodes\": [\n          {\n            \"id\": \"EXT-001\",\n            \"type\": \"external_entity\",\n            \"label\": \"User\"\n          },\n          {\n            \"id\": \"P-001\",\n            \"type\": \"process\",\n            \"label\": \"UMDS PHP Application\"\n          },\n          {\n            \"id\": \"DS-001\",\n            \"type\": \"data_store\",\n            \"label\": \"MySQL/MariaDB Database\"\n          },\n          {\n            \"id\": \"DS-002\",\n            \"type\": \"data_store\",\n            \"label\": \"Upload Directory\"\n          },\n          {\n            \"id\": \"EXT-002\",\n            \"type\": \"external_entity\",\n            \"label\": \"OS System Shell\"\n          }\n        ],\n        \"edges\": [\n          {\n            \"from\": \"EXT-001\",\n            \"to\": \"P-001\",\n            \"label\": \"HTTP/S Requests\"\n          },\n          {\n            \"from\": \"P-001\",\n            \"to\": \"DS-001\",\n            \"label\": \"Queries\"\n          },\n          {\n            \"from\": \"P-001\",\n            \"to\": \"DS-002\",\n            \"label\": \"Read/Write\"\n          },\n          {\n            \"from\": \"P-001\",\n            \"to\": \"EXT-002\",\n            \"label\": \"Command\"\n          },\n          {\n            \"from\": \"EXT-001\",\n            \"to\": \"P-001\",\n            \"label\": \"File Upload\"\n          },\n          {\n            \"from\": \"P-001\",\n            \"to\": \"EXT-001\",\n            \"label\": \"Error/Output\"\n          }\n        ],\n        \"boundaries\": [\n          \"TB-001\",\n          \"TB-002\",\n          \"TB-003\",\n          \"TB-004\",\n          \"TB-005\"\n        ]\n      }\n    ]\n  },\n  \"stride_matrix\": {\n    \"schema_version\": \"1.0\",\n    \"run_id\": \"umds-20240612\",\n    \"rows\": [\n      {\n        \"element_id\": \"P-001\",\n        \"element_type\": \"process\",\n        \"stride\": \"S\",\n        \"applies\": true,\n        \"example\": \"Session fixation, session hijacking due to weak session management.\",\n        \"evidence\": [\n          {\n            \"source_type\": \"requirement\",\n            \"source_id\": \"requirements.pdf#4.1\",\n            \"quote\": \"Basic PHP sessions; No session regeneration\"\n          }\n        ]\n      },\n      {\n        \"element_id\": \"P-001\",\n        \"element_type\": \"process\",\n        \"stride\": \"T\",\n        \"applies\": true,\n        \"example\": \"Privilege escalation to Admin via vulnerabilities (e.g., brute force, lack of input validation).\",\n        \"evidence\": [\n          {\n            \"source_type\": \"requirement\",\n            \"source_id\": \"requirements.pdf#4.1\",\n            \"quote\": \"Default credentials for initial setup (admin/password)\"\n          }\n        ]\n      },\n      {\n        \"element_id\": \"P-001\",\n        \"element_type\": \"process\",\n        \"stride\": \"R\",\n        \"applies\": true,\n        \"example\": \"Authentication bypass, CSRF attack updates password.\",\n        \"evidence\": [\n          {\n            \"source_type\": \"requirement\",\n            \"source_id\": \"requirements.pdf#4.6\",\n            \"quote\": \"Direct form processing without verification; No CSRF protection\"\n          }\n        ]\n      },\n      {\n        \"element_id\": \"P-001\",\n        \"element_type\": \"process\",\n        \"stride\": \"I\",\n        \"applies\": true,\n        \"example\": \"Reflected and stored XSS allows code injection via unsanitized parameters.\",\n        \"evidence\": [\n          {\n            \"source_type\": \"requirement\",\n            \"source_id\": \"requirements.pdf#4.5\",\n            \"quote\": \"Direct output of user input; Direct database storage and retrieval; No output encoding\"\n          }\n        ]\n      },\n      {\n        \"element_id\": \"P-001\",\n        \"element_type\": \"process\",\n        \"stride\": \"D\",\n        \"applies\": true,\n        \"example\": \"Verbose error messages and stack traces reveal sensitive information.\",\n        \"evidence\": [\n          {\n            \"source_type\": \"requirement\",\n            \"source_id\": \"requirements.pdf#7.1\",\n            \"quote\": \"Direct error display for debugging\"\n          }\n        ]\n      },\n      {\n        \"element_id\": \"P-001\",\n        \"element_type\": \"process\",\n        \"stride\": \"E\",\n        \"applies\": true,\n        \"example\": \"Command injection via ping tool input (user input passed to shell).\",\n        \"evidence\": [\n          {\n            \"source_type\": \"requirement\",\n            \"source_id\": \"requirements.pdf#4.4\",\n            \"quote\": \"Direct system command execution; User input passed to shell\"\n          }\n        ]\n      },\n      {\n        \"element_id\": \"DS-001\",\n        \"element_type\": \"data_store\",\n        \"stride\": \"S\",\n        \"applies\": true,\n        \"example\": \"User password hashes and directory info exposed due to weak access controls.\",\n        \"evidence\": [\n          {\n            \"source_type\": \"requirement\",\n            \"source_id\": \"requirements.pdf#3.2\",\n            \"quote\": \"password VARCHAR(32);\"\n          }\n        ]\n      },\n      {\n        \"element_id\": \"DS-001\",\n        \"element_type\": \"data_store\",\n        \"stride\": \"T\",\n        \"applies\": false,\n        \"example\": \"N/A (simple DB, no explicit impersonation mechanism).\",\n        \"evidence\": [\n          {\n            \"source_type\": \"assumption\",\n            \"source_id\": \"requirements.pdf#3.2\",\n            \"quote\": \"Users/roles implemented in process, not enforced at DB.\"\n          }\n        ]\n      },\n      {\n        \"element_id\": \"DS-001\",\n        \"element_type\": \"data_store\",\n        \"stride\": \"R\",\n        \"applies\": true,\n        \"example\": \"SQL Injection allows unauthorized reading or tampering with user records.\",\n        \"evidence\": [\n          {\n            \"source_type\": \"requirement\",\n            \"source_id\": \"requirements.pdf#4.1\",\n            \"quote\": \"Direct SQL query concatenation\"\n          }\n        ]\n      },\n      {\n        \"element_id\": \"DS-001\",\n        \"element_type\": \"data_store\",\n        \"stride\": \"I\",\n        \"applies\": true,\n        \"example\": \"Stored XSS via guestbook comments in the database.\",\n        \"evidence\": [\n          {\n            \"source_type\": \"requirement\",\n            \"source_id\": \"requirements.pdf#4.5\",\n            \"quote\": \"Direct database storage and retrieval; No output encoding\"\n          }\n        ]\n      },\n      {\n        \"element_id\": \"DS-001\",\n        \"element_type\": \"data_store\",\n        \"stride\": \"D\",\n        \"applies\": true,\n        \"example\": \"Database error exposure on failed query.\",\n        \"evidence\": [\n          {\n            \"source_type\": \"requirement\",\n            \"source_id\": \"requirements.pdf#7.1\",\n            \"quote\": \"Direct error display for debugging\"\n          }\n        ]\n      },\n      {\n        \"element_id\": \"DS-001\",\n        \"element_type\": \"data_store\",\n        \"stride\": \"E\",\n        \"applies\": false,\n        \"example\": \"N/A (data store does not execute code).\",\n        \"evidence\": [\n          {\n            \"source_type\": \"assumption\",\n            \"source_id\": \"requirements.pdf#3.2\",\n            \"quote\": \"No user-supplied SQL code is executed in the DB process context.\"\n          }\n        ]\n      },\n      {\n        \"element_id\": \"DS-002\",\n        \"element_type\": \"data_store\",\n        \"stride\": \"S\",\n        \"applies\": true,\n        \"example\": \"Any user can view or replace uploaded files (directory is world-writable and web-accessible).\",\n        \"evidence\": [\n          {\n            \"source_type\": \"requirement\",\n            \"source_id\": \"requirements.pdf#8.2\",\n            \"quote\": \"Web-writable upload directory; Public file access\"\n          }\n        ]\n      },\n      {\n        \"element_id\": \"DS-002\",\n        \"element_type\": \"data_store\",\n        \"stride\": \"T\",\n        \"applies\": false,\n        \"example\": \"N/A (No impersonation via files).\",\n        \"evidence\": [\n          {\n            \"source_type\": \"assumption\",\n            \"source_id\": \"requirements.pdf#4.3\",\n            \"quote\": \"Uploaded files are not execution proxies for impersonation.\"\n          }\n        ]\n      },\n      {\n        \"element_id\": \"DS-002\",\n        \"element_type\": \"data_store\",\n        \"stride\": \"R\",\n        \"applies\": true,\n        \"example\": \"Overwriting legitimate files with attacker-controlled files.\",\n        \"evidence\": [\n          {\n            \"source_type\": \"requirement\",\n            \"source_id\": \"requirements.pdf#4.3\",\n            \"quote\": \"Original filename preservation; Minimal file type checking\"\n          }\n        ]\n      },\n      {\n        \"element_id\": \"DS-002\",\n        \"element_type\": \"data_store\",\n        \"stride\": \"I\",\n        \"applies\": true,\n        \"example\": \"Uploading a web shell or a file with active content.\",\n        \"evidence\": [\n          {\n            \"source_type\": \"requirement\",\n            \"source_id\": \"requirements.pdf#4.3\",\n            \"quote\": \"Minimal file type checking; Web-accessible upload directory\"\n          }\n        ]\n      },\n      {\n        \"element_id\": \"DS-002\",\n        \"element_type\": \"data_store\",\n        \"stride\": \"D\",\n        \"applies\": true,\n        \"example\": \"Directory listings or uploaded file content reveals sensitive information.\",\n        \"evidence\": [\n          {\n            \"source_type\": \"requirement\",\n            \"source_id\": \"requirements.pdf#8.2\",\n            \"quote\": \"Public file access\"\n          }\n        ]\n      },\n      {\n        \"element_id\": \"DS-002\",\n        \"element_type\": \"data_store\",\n        \"stride\": \"E\",\n        \"applies\": true,\n        \"example\": \"Uploading executable scripts (PHP) and running them directly.\",\n        \"evidence\": [\n          {\n            \"source_type\": \"requirement\",\n            \"source_id\": \"requirements.pdf#4.3\",\n            \"quote\": \"Web-accessible upload directory; No restrictions on file content\"\n          }\n        ]\n      },\n      {\n        \"element_id\": \"EXT-001\",\n        \"element_type\": \"external_entity\",\n        \"stride\": \"S\",\n        \"applies\": false,\n        \"example\": \"N/A (User is not trusted infrastructure).\",\n        \"evidence\": [\n          {\n            \"source_type\": \"assumption\",\n            \"source_id\": \"requirements.pdf#2.1\",\n            \"quote\": \"Threat agent, not the trust anchor.\"\n          }\n        ]\n      },\n      {\n        \"element_id\": \"EXT-001\",\n        \"element_type\": \"external_entity\",\n        \"stride\": \"T\",\n        \"applies\": true,\n        \"example\": \"Attacker attempts to escalate privileges e.g., via brute force.\",\n        \"evidence\": [\n          {\n            \"source_type\": \"requirement\",\n            \"source_id\": \"requirements.pdf#10.5\",\n            \"quote\": \"Basic login check with no rate limiting\"\n          }\n        ]\n      },\n      {\n        \"element_id\": \"EXT-001\",\n        \"element_type\": \"external_entity\",\n        \"stride\": \"R\",\n        \"applies\": true,\n        \"example\": \"Attacker masquerades as a legitimate user via weak authentication.\",\n        \"evidence\": [\n          {\n            \"source_type\": \"requirement\",\n            \"source_id\": \"requirements.pdf#9.1\",\n            \"quote\": \"Default Accounts: Username: admin / Password: password\"\n          }\n        ]\n      },\n      {\n        \"element_id\": \"EXT-001\",\n        \"element_type\": \"external_entity\",\n        \"stride\": \"I\",\n        \"applies\": true,\n        \"example\": \"User submits XSS or command injection payload.\",\n        \"evidence\": [\n          {\n            \"source_type\": \"requirement\",\n            \"source_id\": \"requirements.pdf#4.5\",\n            \"quote\": \"Direct output of user input\"\n          }\n        ]\n      },\n      {\n        \"element_id\": \"EXT-001\",\n        \"element_type\": \"external_entity\",\n        \"stride\": \"D\",\n        \"applies\": false,\n        \"example\": \"N/A (user cannot deny actions of application processing).\",\n        \"evidence\": [\n          {\n            \"source_type\": \"assumption\",\n            \"source_id\": \"requirements.pdf#2.1\",\n            \"quote\": \"User as threat agent, deniability not applicable.\"\n          }\n        ]\n      },\n      {\n        \"element_id\": \"EXT-001\",\n        \"element_type\": \"external_entity\",\n        \"stride\": \"E\",\n        \"applies\": true,\n        \"example\": \"User triggers code execution via file upload or command injection.\",\n        \"evidence\": [\n          {\n            \"source_type\": \"requirement\",\n            \"source_id\": \"requirements.pdf#4.4\",\n            \"quote\": \"Direct system command execution\"\n          }\n        ]\n      },\n      {\n        \"element_id\": \"EXT-002\",\n        \"element_type\": \"external_entity\",\n        \"stride\": \"S\",\n        \"applies\": false,\n        \"example\": \"N/A (OS shell is a backend system, not actor).\",\n        \"evidence\": [\n          {\n            \"source_type\": \"assumption\",\n            \"source_id\": \"archiecture_diagram.jpg\",\n            \"quote\": \"Shell not considered trusted.\"\n          }\n        ]\n      },\n      {\n        \"element_id\": \"EXT-002\",\n        \"element_type\": \"external_entity\",\n        \"stride\": \"T\",\n        \"applies\": false,\n        \"example\": \"N/A (no impersonation upward from shell).\",\n        \"evidence\": [\n          {\n            \"source_type\": \"assumption\",\n            \"source_id\": \"archiecture_diagram.jpg\",\n            \"quote\": \"No lateral movement modeled.\"\n          }\n        ]\n      },\n      {\n        \"element_id\": \"EXT-002\",\n        \"element_type\": \"external_entity\",\n        \"stride\": \"R\",\n        \"applies\": false,\n        \"example\": \"N/A (shell acts on command, not on its own).\",\n        \"evidence\": [\n          {\n            \"source_type\": \"assumption\",\n            \"source_id\": \"requirements.pdf#4.4\",\n            \"quote\": \"Shell only processes what the application gives.\"\n          }\n        ]\n      },\n      {\n        \"element_id\": \"EXT-002\",\n        \"element_type\": \"external_entity\",\n        \"stride\": \"I\",\n        \"applies\": false,\n        \"example\": \"N/A (threat not from OS Shell).\",\n        \"evidence\": [\n          {\n            \"source_type\": \"assumption\",\n            \"source_id\": \"requirements.pdf#4.4\",\n            \"quote\": \"Shell is passive recipient.\"\n          }\n        ]\n      },\n      {\n        \"element_id\": \"EXT-002\",\n        \"element_type\": \"external_entity\",\n        \"stride\": \"D\",\n        \"applies\": false,\n        \"example\": \"N/A.\",\n        \"evidence\": [\n          {\n            \"source_type\": \"assumption\",\n            \"source_id\": \"archiecture_diagram.jpg\",\n            \"quote\": \"Denial of service or repudiation not modeled from OS.\"\n          }\n        ]\n      },\n      {\n        \"element_id\": \"EXT-002\",\n        \"element_type\": \"external_entity\",\n        \"stride\": \"E\",\n        \"applies\": false,\n        \"example\": \"N/A (shell is not user-supplied code, but is code execution destination).\",\n        \"evidence\": [\n          {\n            \"source_type\": \"assumption\",\n            \"source_id\": \"requirements.pdf#4.4\",\n            \"quote\": \"All code execution in shell is by process request.\"\n          }\n        ]\n      }\n    ],\n    \"coverage_pct\": 100\n  }\n}",
  "{\n  \"trust_boundaries\": {\n    \"schema_version\": \"1.0\",\n    \"run_id\": \"umds-security-analysis-001\",\n    \"boundaries\": [\n      {\n        \"id\": \"TB-001\",\n        \"name\": \"Web Application Boundary\",\n        \"description\": \"Encompasses the UMDS web application components\",\n        \"elements\": [\"P-001\", \"P-002\", \"P-003\", \"P-004\", \"P-005\", \"P-006\", \"DS-001\", \"DS-002\"]\n      },\n      {\n        \"id\": \"TB-002\",\n        \"name\": \"Operating System Boundary\",\n        \"description\": \"System-level commands and operations\",\n        \"elements\": [\"P-004\"]\n      },\n      {\n        \"id\": \"TB-003\",\n        \"name\": \"File System Boundary\",\n        \"description\": \"File storage and access\",\n        \"elements\": [\"DS-002\"]\n      }\n    ],\n    \"evidence\": [\n      {\n        \"source_type\": \"requirement\",\n        \"source_id\": \"requirements.pdf\",\n        \"quote\": \"The User Management and Directory System (UMDS) is a web-based application designed to provide a simple user directory and basic administrative interface for small organizations.\"\n      },\n      {\n        \"source_type\": \"requirement\",\n        \"source_id\": \"requirements.pdf\",\n        \"quote\": \"Direct system command execution for efficiency\"\n      },\n      {\n        \"source_type\": \"requirement\",\n        \"source_id\": \"requirements.pdf\",\n        \"quote\": \"Simple file storage in web-accessible directory\"\n      }\n    ]\n  },\n  \"dfds\": {\n    \"schema_version\": \"1.0\",\n    \"run_id\": \"umds-security-analysis-001\",\n    \"dfds\": [\n      {\n        \"id\": \"DFD-001\",\n        \"title\": \"UMDS System Overview\",\n        \"mermaid\": \"flowchart TD\\n    EXT-001[User] --> P-001[Authentication Module]\\n    EXT-001 --> P-002[User Directory Module]\\n    EXT-001 --> P-003[File Upload Module]\\n    EXT-001 --> P-004[Network Diagnostics Module]\\n    EXT-001 --> P-005[Guestbook/Comment Module]\\n    EXT-001 --> P-006[Admin Module]\\n    P-001 <--> DS-001[(User Database)]\\n    P-002 <--> DS-001\\n    P-003 --> DS-002[(File Storage)]\\n    P-004 <--> EXT-002[Operating System]\\n    P-005 <--> DS-001\\n    P-006 <--> DS-001\\n    \\n    subgraph TB-001[Web Application Boundary]\\n        P-001\\n        P-002\\n        P-003\\n        P-004\\n        P-005\\n        P-006\\n        DS-001\\n        DS-002\\n    end\\n    \\n    subgraph TB-002[Operating System Boundary]\\n        P-004\\n    end\\n    \\n    subgraph TB-003[File System Boundary]\\n        DS-002\\n    end\",\n        \"nodes\": [\n          {\n            \"id\": \"EXT-001\",\n            \"type\": \"external_entity\",\n            \"label\": \"User\"\n          },\n          {\n            \"id\": \"EXT-002\",\n            \"type\": \"external_entity\",\n            \"label\": \"Operating System\"\n          },\n          {\n            \"id\": \"P-001\",\n            \"type\": \"process\",\n            \"label\": \"Authentication Module\"\n          },\n          {\n            \"id\": \"P-002\",\n            \"type\": \"process\",\n            \"label\": \"User Directory Module\"\n          },\n          {\n            \"id\": \"P-003\",\n            \"type\": \"process\",\n            \"label\": \"File Upload Module\"\n          },\n          {\n            \"id\": \"P-004\",\n            \"type\": \"process\",\n            \"label\": \"Network Diagnostics"
]